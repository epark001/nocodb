import{_ as R}from"./View.ef09e6e0.js";import{h as N,r as f,cb as T,i as w,k as U,o as g,c as y,a as p,b as v,E as i,H as $,W as V,J as a,K as s,f as A}from"./entry.51f4e399.js";import{u as D}from"./useDashboard.fc1e1c09.js";import{a as G}from"./useMetas.ba7abae7.js";import{_ as L}from"./index.e56af360.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./useSmartsheetStore.1784ce8b.js";import"./views.28a76d89.js";import"./useSharedView.0db5f32b.js";import"./index.5263eb1d.js";import"./index.b9981e09.js";import"./Password.d493e47a.js";import"./Input.7cb175ff.js";import"./antInputDirective.8ac36ea7.js";import"./FormItemContext.e001cd7c.js";import"./ProjectIcon.92319bff.js";import"./Button.vue.793bcd1d.js";import"./index.0db47614.js";import"./debounce.7d32c110.js";import"./toNumber.9dc54e53.js";import"./isSymbol.b53bd26f.js";import"./useCopy.3e897b55.js";import"./v3-infinite-loading.1863e829.js";import"./index.8fa2fb32.js";import"./QuickImport.vue.b0890f2c.js";import"./validation.6db726f3.js";import"./index.de92142d.js";import"./FormItem.cda40628.js";import"./identity.dd5da9ba.js";import"./_getPrototype.ec1165af.js";import"./Col.88cfabc0.js";import"./responsiveObserve.501a6cf9.js";import"./toArray.06afb623.js";import"./useSize.3b3f469f.js";import"./_flatRest.ff2d3d5c.js";import"./isPlainObject.ecf52d25.js";import"./CheckOutlined.ef30fafc.js";import"./useRefs.154aa2be.js";import"./useMergedState.5e6500b1.js";import"./index.c4aafe5c.js";import"./Dropdown.dc69c0a4.js";import"./useState.6010d8b6.js";import"./isMobile.e2e89480.js";import"./index.e760d172.js";import"./SearchOutlined.dec109ce.js";import"./TextArea.442a25cb.js";import"./index.2b3cfde3.js";import"./index.181e79e4.js";import"./DownOutlined.db6f6406.js";import"./index.0d6d8ba8.js";import"./Checkbox.a529f1e6.js";import"./createForOfIteratorHelper.12419aa5.js";import"./OpenLeftSidebarBtn.vue.7f8f7dc2.js";import"./Icon.vue.1162f18b.js";import"./Tooltip.vue.f55045dc.js";import"./sidebar.e289f4e1.js";import"./plus.21827b47.js";import"./Modal.vue.d8394846.js";import"./tab.da86c3fb.js";import"./index.529d8b39.js";import"./index.680937e8.js";import"./index.fbcca285.js";import"./Modal.vue.b59a28af.js";import"./index.277e21b7.js";import"./index.9e760c64.js";import"./domUtils.b0dc23e8.js";import"./Select.vue.e482f984.js";import"./index.5e746f62.js";import"./useMemo.b13a9257.js";import"./chevron-down.b89ef60a.js";import"./send-outline.f2f3f49c.js";import"./index.7230021b.js";import"./index.e5ddde08.js";import"./DeleteModal.vue.909e0964.js";import"./vuedraggable.umd.f8ba38de.js";import"./Editor.vue.08021a9c.js";import"./deepCompare.d32ec333.js";import"./fileUtils.43128440.js";import"./index.9194faf6.js";import"./RightOutlined.90e8180f.js";import"./TableIcon.vue.27fb2d8a.js";import"./index.714e2a51.js";import"./eagerComputed.6062ac13.js";import"./index.09b19c06.js";import"./LeftOutlined.3bb8aa17.js";import"./useBreakpoint.a91853f1.js";import"./index.a3117839.js";import"./index.252dc7b4.js";import"./index.2a1a64ce.js";import"./TruncateText.vue.bbf76296.js";import"./ViewIcon.vue.9fe867dc.js";import"./View.vue.877cd4d6.js";import"./Overlay.8132102a.js";import"./index.29c48461.js";import"./index.ad7bdb4a.js";const M={class:"flex flex-col py-2 px-3 gap-2 w-full","data-testid":"nc-share-base-sub-modal"},P={class:"flex flex-col w-full p-3 border-1 border-gray-100 rounded-md"},H={class:"flex flex-row w-full justify-between"},J=p("div",{class:"text-black font-medium"},"Enable Public Access",-1),K={key:0,class:"flex flex-col w-full mt-3 border-t-1 pt-3 border-gray-100"},W={class:"flex flex-row justify-between mt-3 bg-gray-50 px-3 py-2 rounded-md"},q=p("div",{class:"text-black"},"Editing access",-1),Ao=N({__name:"ShareBase",setup(z){const{dashboardUrl:x}=D(),{$api:c,$e:_}=A(),o=f(null),{project:r}=T(G()),n=w(()=>o.value&&o.value.uuid?`${x.value}#/base/${o.value.uuid}`:""),k=async()=>{try{if(!r.value.id)return;const t=await c.project.sharedBaseGet(r.value.id);o.value={uuid:t.uuid,url:t.url,role:t.roles}}catch(t){a.error(await s(t))}},u=async(t="viewer")=>{try{if(!r.value.id)return;const e=await c.project.sharedBaseUpdate(r.value.id,{roles:t});o.value=e??{},o.value.role=t}catch(e){a.error(await s(e))}_("a:shared-base:enable",{role:t})},B=async()=>{try{if(!r.value.id)return;await c.project.sharedBaseDisable(r.value.id),o.value=null}catch(t){a.error(await s(t))}_("a:shared-base:disable")};U(()=>{o.value||k()});const d=w(()=>{var t;return!!((t=o.value)!=null&&t.uuid)}),l=f(!1),m=f(!1),j=async()=>{if(!l.value){l.value=!0;try{d.value?await B():await u()}catch(t){a.error(await s(t))}finally{l.value=!1}}},E=async()=>{if(o.value&&!m.value){m.value=!0;try{o.value.role==="viewer"?await u("editor"):await u("viewer")}catch(t){a.error(await s(t))}finally{m.value=!1}}};return(t,e)=>{var b;const h=L,S=R;return g(),y("div",M,[p("div",P,[p("div",H,[J,v(h,{checked:i(d),loading:i(l),class:"ml-2",onClick:j},null,8,["checked","loading"])]),i(d)?(g(),y("div",K,[v(S,{url:i(n),"onUpdate:url":e[0]||(e[0]=C=>$(n)?n.value=C:null)},null,8,["url"]),p("div",W,[q,v(h,{loading:i(m),checked:((b=i(o))==null?void 0:b.role)==="editor",class:"ml-2",onClick:E},null,8,["loading","checked"])])])):V("",!0)])])}}});export{Ao as default};
