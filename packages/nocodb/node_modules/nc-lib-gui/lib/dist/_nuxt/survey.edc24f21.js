import{o as s,c as l,a as n,h as Ce,fc as Le,A as Ve,r as h,Z as de,i as Q,fd as Te,U as W,k as Ee,fe as Re,E as e,t as x,W as c,b as d,w as v,bP as R,Q as D,ff as Ae,f3 as me,C as y,I as g,cd as $,aj as _e,cp as De,d as A,D as N,F as U,R as O,f4 as Oe,_ as Pe,J as fe}from"./entry.51f4e399.js";import{_ as Ie}from"./PoweredBy.vue.52c368af.js";import{p as ze}from"./useMetas.ba7abae7.js";import{I as qe,D as Fe}from"./index.5263eb1d.js";import{i as Be}from"./urlUtils.a77f6d4a.js";import{u as Ne}from"./useSharedFormViewStore.b1e9bc79.js";import{v as Ue}from"./validation.6db726f3.js";import"./NocoIcon.vue.6ea1cae5.js";import"./256x256-trans.2cd7e00a.js";import"./256x256.3b34edca.js";import"./index.b9981e09.js";import"./useSmartsheetRowStore.aafbb4bb.js";import"./deepCompare.d32ec333.js";import"./dataUtils.edecace3.js";import"./virtualCell.4dce1393.js";import"./views.28a76d89.js";import"./useSharedView.0db5f32b.js";const Me={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},je=n("path",{fill:"currentColor",d:"m9 18l-6-6l6-6l1.4 1.4L6.8 11H19V7h2v6H6.8l3.6 3.6L9 18Z"},null,-1),He=[je];function Ge(i,M){return s(),l("svg",Me,He)}const Ze={name:"material-symbols-keyboard-return",render:Ge},Ke={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Je=n("path",{fill:"currentColor",d:"M15 18v-6h2.17L12 6.83L6.83 12H9v6h6M12 4l10 10h-5v6H7v-6H2L12 4Z"},null,-1),Qe=[Je];function We(i,M){return s(),l("svg",Ke,Qe)}const Ye={name:"mdi-apple-keyboard-shift",render:We},Xe=D(()=>O(()=>import("./VirtualCell.44092918.js"),["./VirtualCell.44092918.js","./entry.51f4e399.js","./entry.0f786d51.css","./EditOrAddProvider.vue.09b12d8b.js","./Icon.vue.1162f18b.js","./Button.vue.793bcd1d.js","./index.0db47614.js","./debounce.7d32c110.js","./toNumber.9dc54e53.js","./isSymbol.b53bd26f.js","./_plugin-vue_export-helper.c27b6911.js","./Button.95d2a5ed.css","./useBetaFeatureToggle.5dbba600.js","./index.5263eb1d.js","./index.e5ddde08.js","./validation.6db726f3.js","./useMetas.ba7abae7.js","./index.de92142d.js","./FormItem.cda40628.js","./identity.dd5da9ba.js","./_getPrototype.ec1165af.js","./Col.88cfabc0.js","./responsiveObserve.501a6cf9.js","./toArray.06afb623.js","./FormItemContext.e001cd7c.js","./useSize.3b3f469f.js","./_flatRest.ff2d3d5c.js","./isPlainObject.ecf52d25.js","./index.e760d172.js","./Input.7cb175ff.js","./antInputDirective.8ac36ea7.js","./SearchOutlined.dec109ce.js","./TextArea.442a25cb.js","./Password.d493e47a.js","./index.0d6d8ba8.js","./Checkbox.a529f1e6.js","./createForOfIteratorHelper.12419aa5.js","./index.5e746f62.js","./isMobile.e2e89480.js","./useMemo.b13a9257.js","./useMergedState.5e6500b1.js","./useState.6010d8b6.js","./DownOutlined.db6f6406.js","./CheckOutlined.ef30fafc.js","./EditOrAddProvider.44ca9c5b.css","./virtualCell.4dce1393.js","./index.9e760c64.js","./index.252dc7b4.js","./Dropdown.dc69c0a4.js","./RightOutlined.90e8180f.js","./VirtualCell.23f24363.css"],import.meta.url).then(i=>i.default||i)),et=D(()=>O(()=>import("./Cell.aa14ce01.js"),["./Cell.aa14ce01.js","./entry.51f4e399.js","./entry.0f786d51.css","./CellIcon.8a6080fd.js","./index.5263eb1d.js","./cell.1732684e.js","./useMetas.ba7abae7.js","./EditOrAddProvider.vue.09b12d8b.js","./Icon.vue.1162f18b.js","./Button.vue.793bcd1d.js","./index.0db47614.js","./debounce.7d32c110.js","./toNumber.9dc54e53.js","./isSymbol.b53bd26f.js","./_plugin-vue_export-helper.c27b6911.js","./Button.95d2a5ed.css","./useBetaFeatureToggle.5dbba600.js","./index.e5ddde08.js","./validation.6db726f3.js","./index.de92142d.js","./FormItem.cda40628.js","./identity.dd5da9ba.js","./_getPrototype.ec1165af.js","./Col.88cfabc0.js","./responsiveObserve.501a6cf9.js","./toArray.06afb623.js","./FormItemContext.e001cd7c.js","./useSize.3b3f469f.js","./_flatRest.ff2d3d5c.js","./isPlainObject.ecf52d25.js","./index.e760d172.js","./Input.7cb175ff.js","./antInputDirective.8ac36ea7.js","./SearchOutlined.dec109ce.js","./TextArea.442a25cb.js","./Password.d493e47a.js","./index.0d6d8ba8.js","./Checkbox.a529f1e6.js","./createForOfIteratorHelper.12419aa5.js","./index.5e746f62.js","./isMobile.e2e89480.js","./useMemo.b13a9257.js","./useMergedState.5e6500b1.js","./useState.6010d8b6.js","./DownOutlined.db6f6406.js","./CheckOutlined.ef30fafc.js","./EditOrAddProvider.44ca9c5b.css","./index.9e760c64.js","./index.252dc7b4.js","./Dropdown.dc69c0a4.js","./RightOutlined.90e8180f.js","./Cell.c77dfd55.css"],import.meta.url).then(i=>i.default||i)),tt=D(()=>O(()=>import("./VirtualCell.4b63c3ca.js"),["./VirtualCell.4b63c3ca.js","./entry.51f4e399.js","./entry.0f786d51.css","./index.5263eb1d.js","./virtualCell.4dce1393.js"],import.meta.url).then(i=>i.default||i)),ot=D(()=>O(()=>import("./Cell.4f83cd62.js"),["./Cell.4f83cd62.js","./entry.51f4e399.js","./entry.0f786d51.css","./index.5263eb1d.js","./cell.1732684e.js","./useMetas.ba7abae7.js","./useSmartsheetRowStore.aafbb4bb.js","./deepCompare.d32ec333.js","./dataUtils.edecace3.js","./virtualCell.4dce1393.js","./index.b9981e09.js","./_plugin-vue_export-helper.c27b6911.js","./Cell.69966cf7.css"],import.meta.url).then(i=>i.default||i)),st=D(()=>O(()=>import("./DivDataCell.806c1c42.js"),["./DivDataCell.806c1c42.js","./index.5263eb1d.js","./entry.51f4e399.js","./entry.0f786d51.css"],import.meta.url).then(i=>i.default||i)),at={key:0,style:{height:"max(40vh, 225px)","min-height":"225px"},class:"max-w-[max(33%,600px)] mx-auto flex flex-col justify-end"},lt={class:"px-4 md:px-0 flex flex-col justify-end"},rt={class:"prose-2xl font-bold self-center my-4","data-testid":"nc-survey-form__heading",style:{"word-break":"break-all"}},nt={key:0,class:"prose-lg text-slate-500 dark:text-slate-300 self-center mb-4 leading-6",style:{"word-break":"break-all"},"data-testid":"nc-survey-form__sub-heading"},it={class:"h-full w-full flex items-center px-4 md:px-0"},ut={key:0,class:"flex flex-col gap-2"},ct={class:"flex nc-form-column-label","data-testid":"nc-form-column-label"},dt={class:"flex flex-col gap-2 text-slate-500 dark:text-slate-300 text-[0.75rem] my-2 px-1",style:{"word-break":"break-all"}},mt={key:0,class:"text-sm text-gray-500 flex flex-wrap items-center"},_t={class:"ml-1 mt-4 flex w-full text-lg"},ft={class:"flex-1 flex justify-center"},pt={key:0,class:"text-center my-4"},xt={key:1,class:"flex items-center gap-3 flex-col"},vt={key:0,class:"uppercase text-white"},yt={class:"hidden md:flex text-sm text-gray-500 items-center gap-1"},ht={key:0,class:"flex flex-col justify-center items-center text-center"},gt={class:"text-lg px-6 py-3 bg-green-300 text-gray-700 rounded","data-testid":"nc-survey-form__success-msg"},bt={key:1,class:"flex flex-col gap-1"},kt=n("div",null,"Thank you!",-1),wt=n("div",null,"You have successfully submitted the form data.",-1),St=[kt,wt],$t={key:0,class:"mt-3"},Ct={key:0,class:"text-xs text-slate-500 dark:text-slate-300 text-center my-4"},Lt={key:1,class:"text-center"},Vt={key:1,class:"mb-24 md:my-4 select-none text-center text-gray-500 dark:text-slate-200","data-testid":"nc-survey-form__footer"},Tt={class:"relative flex w-full items-end"},Et={key:0,class:"color-transition shadow-sm absolute bottom-18 right-1/2 transform translate-x-[50%] md:bottom-4 md:right-12 md:transform-none flex items-center bg-white border dark:bg-slate-500 rounded divide-x-1"},Kt=Ce({__name:"survey",setup(i){const{md:M}=Le(Ae),{v$:m,formState:b,formColumns:C,submitForm:pe,submitted:_,secondsRemain:xe,sharedFormView:f,sharedViewMeta:ve,onReset:ye}=Ne(),{t:Y}=Ve(),j=h(!1),P=h("left"),L=h("arrow-right"),k=h(!1),I=h([]),z=h();de(Fe,z),de(qe,h(!0));const q=Q(()=>ve.value.transitionDuration||50),X=Q(()=>C.value?C.value.reduce((o,a)=>{const u=a.label||a.title;return u&&o.push(u),o},[]):[]),{index:w,goToPrevious:he,goToNext:ge,isFirst:H,isLast:F,goTo:be}=Te(X),t=Q(()=>{var o;return(o=C.value)==null?void 0:o[w.value]}),V=h(!1);function ee(o,a=!1){var B;let u=o;return u.uidt===$.LinkToAnotherRecord&&u.colOptions&&u.colOptions.type===Oe.BELONGS_TO&&(u=(B=C.value)==null?void 0:B.find(K=>K.id===u.colOptions.fk_child_column_id)),a||u&&u.rqd&&!u.cdf}function G(o){j.value=!0,P.value=o,setTimeout(()=>{P.value=P.value==="left"?"right":"left"},q.value/2),setTimeout(()=>{j.value=!1,setTimeout(se,100)},q.value)}function te(o){L.value=o,k.value=!0,setTimeout(()=>{k.value=!1},q.value/2)}async function oe(){var a;const o=t.value;if((a=ze(o.meta))!=null&&a.validate&&b.value[o.title]){if(o.uidt===$.Email){if(!Ue(b.value[o.title]))return V.value=!0,fe.error(Y("msg.error.invalidEmail")),!1}else if(o.uidt===$.URL&&!Be(b.value[o.title]))return V.value=!0,fe.error(Y("msg.error.invalidURL")),!1}return!0}async function T(o){if(V.value=!1,F.value||_.value||!t.value||!t.value.title)return;const a=m.value.localState[t.value.title];a&&!await a.$validate()||await oe()&&(te(o||"arrow-right"),setTimeout(()=>{G("left"),ge()},o==="ok-button"?300:0))}async function Z(o){H.value||_.value||(te(o||"arrow-left"),G("right"),he())}function se(){if(document&&typeof document<"u"){const o=document.querySelector(".nc-cell input")||document.querySelector(".nc-cell textarea");o&&(o.select(),o.focus())}}function ae(){m.value.$reset(),_.value=!1,G("right"),be(X.value[0])}async function le(){_.value||!await oe()||pe()}return ye(ae),W(["ArrowLeft","ArrowDown"],()=>{Z("arrow-left")}),W(["ArrowRight","ArrowUp"],()=>{T("arrow-right")}),W(["Enter","Space"],()=>{F.value?le():T("ok-button")}),Ee(()=>{if(se(),!M.value){const{direction:o}=Re(z,{onSwipe:()=>{j.value||(o.value==="left"?T():o.value==="right"&&Z())}})}}),(o,a)=>{var ne,ie;const u=Xe,B=et,K=tt,ke=ot,we=Ye,re=Ze,Se=st,J=Pe,$e=Ie;return s(),l("div",{ref_key:"el",ref:z,class:"survey pt-8 md:p-0 w-full h-full flex flex-col"},[e(f)?(s(),l("div",at,[n("div",lt,[n("h1",rt,x(e(f).heading),1),e(f).subheading&&e(f).subheading!==""?(s(),l("h2",nt,x((ne=e(f))==null?void 0:ne.subheading),1)):c("",!0)])])):c("",!0),n("div",it,[d(R,{name:`slide-${e(P)}`,duration:e(q),mode:"out-in"},{default:v(()=>{var E,S;return[(s(),l("div",{ref_key:"el",ref:z,key:(E=e(t))==null?void 0:E.title,class:"color-transition h-full flex flex-col mt-6 gap-4 w-full max-w-[max(33%,600px)] m-auto"},[e(t)&&!e(_)?(s(),l("div",ut,[n("div",ct,[e(me)(e(t))?(s(),y(u,{key:0,column:{...e(t),title:e(t).label||e(t).title},required:ee(e(t),e(t).required),"hide-menu":!0},null,8,["column","required"])):(s(),y(B,{key:1,class:g(e(t).uidt===e($).Checkbox?"nc-form-column-label__checkbox":""),column:{meta:{},...e(t),title:e(t).label||e(t).title},required:ee(e(t),e(t).required),"hide-menu":!0},null,8,["class","column","required"]))]),e(t).title?(s(),y(Se,{key:0,class:"relative"},{default:v(()=>{var p;return[e(me)(e(t))?(s(),y(K,{key:0,modelValue:e(b)[e(t).title],"onUpdate:modelValue":a[0]||(a[0]=r=>e(b)[e(t).title]=r),class:"mt-0 nc-input h-auto",row:{row:{},oldRow:{},rowMeta:{}},"data-testid":`nc-survey-form__input-${e(t).title.replaceAll(" ","")}`,column:e(t)},null,8,["modelValue","data-testid","column"])):(s(),y(ke,{key:1,modelValue:e(b)[e(t).title],"onUpdate:modelValue":a[1]||(a[1]=r=>e(b)[e(t).title]=r),class:"nc-input h-auto","data-testid":`nc-survey-form__input-${e(t).title.replaceAll(" ","")}`,column:e(t),"edit-enabled":e(I)[e(w)],onClick:a[2]||(a[2]=r=>e(I)[e(w)]=!0),onCancel:a[3]||(a[3]=r=>e(I)[e(w)]=!1),"onUpdate:editEnabled":a[4]||(a[4]=r=>e(I)[e(w)]=r)},null,8,["modelValue","data-testid","column","edit-enabled"])),n("div",dt,[(s(!0),l(_e,null,De((p=e(m).localState[e(t).title])==null?void 0:p.$errors,r=>(s(),l("div",{key:r,class:"text-red-500"},x(r.$message),1))),128)),n("div",{class:g(["block text-[14px]",e(t).uidt===e($).Checkbox?"text-center":""]),"data-testid":"nc-survey-form__field-description"},x(e(t).description),3),e(t).uidt===e($).LongText?(s(),l("div",mt,[A(" Shift "),d(we,{class:"mx-1 text-primary"}),A(" + Enter "),d(re,{class:"mx-1 text-primary"}),A(" to make a line break ")])):c("",!0)])]}),_:1})):c("",!0)])):c("",!0),n("div",_t,[n("div",ft,[e(F)&&!e(_)&&!e(m).$invalid?(s(),l("div",pt,[n("button",{class:g([e(L)==="submit-button"&&e(k)?"transform translate-y-[1px] translate-x-[1px] ring ring-accent ring-opacity-100":"","uppercase scaling-btn prose-sm"]),type:"submit","data-testid":"nc-survey-form__btn-submit",onClick:le},x(o.$t("general.submit")),3)])):e(_)?c("",!0):(s(),l("div",xt,[d(J,{title:(S=e(m).localState[e(t).title])!=null&&S.$error?e(m).localState[e(t).title].$errors[0].$message:"Go to next","mouse-enter-delay":.25,"mouse-leave-delay":0},{default:v(()=>{var p;return[n("button",{class:g(["bg-opacity-100 scaling-btn flex items-center gap-1",[(p=e(m).localState[e(t).title])!=null&&p.$error||e(V)?"after:!bg-gray-100 after:!ring-red-500":"",e(L)==="ok-button"&&e(k)?"transform translate-y-[2px] translate-x-[2px] !after:ring !after:ring-accent !after:ring-opacity-100":""]]),"data-testid":"nc-survey-form__btn-next",onClick:a[5]||(a[5]=r=>T())},[d(R,{name:"fade"},{default:v(()=>{var r;return[(r=e(m).localState[e(t).title])!=null&&r.$error?c("",!0):(s(),l("span",vt,"Ok"))]}),_:1}),d(R,{name:"slide-right",mode:"out-in"},{default:v(()=>{var r;return[(r=e(m).localState[e(t).title])!=null&&r.$error||e(V)?(s(),y(N(e(U).closeCircle),{key:0,class:"text-red-500 md:text-md"})):(s(),y(N(e(U).check),{key:1,class:"text-white md:text-md"}))]}),_:1})],2)]}),_:1},8,["title"]),n("div",yt,[A(" Press Enter "),d(re,{class:"text-primary"})])]))])]),d(R,{name:"slide-left"},{default:v(()=>{var p,r,ue,ce;return[e(_)?(s(),l("div",ht,[n("div",gt,[(p=e(f))!=null&&p.success_msg?(s(),l(_e,{key:0},[A(x((r=e(f))==null?void 0:r.success_msg),1)],64)):(s(),l("div",bt,St))]),e(f)?(s(),l("div",$t,[(ue=e(f))!=null&&ue.show_blank_form?(s(),l("p",Ct," New form will be loaded after "+x(e(xe))+" seconds ",1)):c("",!0),(ce=e(f))!=null&&ce.submit_another_form?(s(),l("div",Lt,[n("button",{type:"button",class:"scaling-btn bg-opacity-100","data-testid":"nc-survey-form__btn-submit-another-form",onClick:ae}," Submit Another Form ")])):c("",!0)])):c("",!0)])):c("",!0)]}),_:1})]))]}),_:1},8,["name","duration"])]),e(_)?c("",!0):(s(),l("div",Vt,x(e(w)+1)+" / "+x((ie=e(C))==null?void 0:ie.length),1)),n("div",Tt,[d(R,{name:"fade"},{default:v(()=>{var E;return[e(_)?c("",!0):(s(),l("div",Et,[d(J,{title:e(H)?"":"Go to previous","mouse-enter-delay":.25,"mouse-leave-delay":0},{default:v(()=>[n("button",{class:g([e(L)==="arrow-left"&&e(k)?"transform translate-y-[1px] translate-x-[1px] text-primary":"","p-0.5 flex items-center group color-transition"]),"data-testid":"nc-survey-form__icon-prev",onClick:a[6]||(a[6]=S=>Z())},[(s(),y(N(e(U).chevronLeft),{class:g([e(H)?"text-gray-300":"group-hover:text-accent","text-2xl md:text-md"])},null,8,["class"]))],2)]),_:1},8,["title"]),d(J,{title:(E=e(m).localState[e(t).title])!=null&&E.$error?"":"Go to next","mouse-enter-delay":.25,"mouse-leave-delay":0},{default:v(()=>{var S;return[n("button",{class:g([e(L)==="arrow-right"&&e(k)?"transform translate-y-[1px] translate-x-[-1px] text-primary":"","p-0.5 flex items-center group color-transition"]),"data-testid":"nc-survey-form__icon-next",onClick:a[7]||(a[7]=p=>T())},[(s(),y(N(e(U).chevronRight),{class:g([[e(F)||(S=e(m).localState[e(t).title])!=null&&S.$error?"text-gray-300":"group-hover:text-accent"],"text-2xl md:text-md"])},null,8,["class"]))],2)]}),_:1},8,["title"])]))]}),_:1}),d($e)])],512)}}});export{Kt as default};
