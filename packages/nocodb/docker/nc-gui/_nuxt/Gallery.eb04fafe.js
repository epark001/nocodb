import{h as Pe,$ as f,r as m,cg as Se,cb as ze,Z as S,c4 as Le,g as Ue,i as k,ap as je,aq as Be,fb as Fe,cI as Te,o as l,c as r,b as I,w as i,E as e,C as d,aV as ee,d as te,t as oe,W as y,a as _,I as Me,aj as w,cp as z,b5 as Oe,dD as Ye,f3 as ae,H as L,d6 as ne,fD as le,Q as c,R as p,M as Ge,N as Ne,p as Qe,e as $e}from"./entry.13466615.js";import{u as qe}from"./views.3cd4bcb9.js";import{a as He}from"./useSmartsheetStore.9bdf3b91.js";import{u as Je}from"./index.e7cf7635.js";import{M as We,A as Ke,e as Ze,R as Xe,O as et,c as tt,u as ot,l as at,b as nt,F as lt,w as st}from"./index.5263eb1d.js";import{e as rt}from"./dataUtils.31dbfaee.js";import{i as it}from"./fileUtils.43128440.js";import{k as ut}from"./virtualCell.88c63e03.js";import{u as mt}from"./useAttachment.e270c182.js";import{u as dt}from"./useViewData.c2e6f1c7.js";import{_ as _t}from"./index.9b549237.js";import{C as ct}from"./index.3cc83813.js";import{D as pt}from"./index.82f05b6c.js";import{_ as ft}from"./Input.2c73684e.js";import{_ as vt}from"./_plugin-vue_export-helper.c27b6911.js";import"./useMetas.223da623.js";import"./useSharedView.746b4f21.js";import"./index.2a3da6a9.js";import"./urlUtils.f6dc4ebc.js";import"./debounce.dbc9bf77.js";import"./toNumber.7aa6a805.js";import"./isSymbol.b9109ae5.js";import"./index.62e3d60f.js";import"./Dropdown.a78be736.js";import"./useState.a6853ebd.js";import"./useRefs.6ea70d5c.js";import"./identity.b813b76e.js";import"./_flatRest.037bf8e3.js";import"./isMobile.e2e89480.js";import"./useMergedState.1cc2a884.js";import"./index.638acbb4.js";import"./Col.23d910dc.js";import"./responsiveObserve.9209e727.js";import"./index.89133b21.js";import"./isPlainObject.4c0f42f1.js";import"./_getPrototype.00be30f0.js";import"./RightOutlined.2c092523.js";const yt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAABlUlEQVR4Ae2Z0W3CMBBAz6YtQvwwQvPVRvBBNmhHYARG6AawQZmgK3QENmh/UNSvMoJ/kYhdH/mx2pxbnDRO0D0JJfJdxL3kwIkDwDAMExPhC+Z5fmvM4EVrMxcCJtAyQoitEMUyTdM9mUMFsPiikG8xCv+GklJnlISkjsIz34HikQnWQgU9AuYBOoKtZU7FJPQDshP6IkDCArFhgdiwQGxYIDYsEBsWiE3bAsp+XqFBWhWw9/Xr6fRuYbdP0BCNCJTPrrD35diiN7PZ/TPu49Y+Z2+gAWoLYOGj0fXicLjJKAkcH4+HK3fseByufpP+C3UFlBD6MUkSlWXJad+YU59X5riDnvyzqCWAPe2uFpT7Zu3LcanKP5dgAbenXdz+pnKo/BCCBKp62qXsb7H15fzMD/s9kAtbu92HoWJ2oSnxrZaFgAtpWstPKm7/fitr7f1MfAUB4JmyVwiaRGsIgu+FYnO5AnVnyLYgBaQU79ARcE6hYpI+qFh25CoorIUKkgI4UQ0GOvPZ/zMKv9v3doZhGCY+X0jQoY0k5Yn0AAAAAElFTkSuQmCC",wt=c(()=>p(()=>import("./Image.e926e9ff.js"),["./Image.e926e9ff.js","./entry.13466615.js","./entry.0f786d51.css"],import.meta.url).then(a=>a.default||a)),gt=c(()=>p(()=>import("./VirtualCell.79aff6cf.js"),["./VirtualCell.79aff6cf.js","./entry.13466615.js","./entry.0f786d51.css","./EditOrAddProvider.vue.9fbafb18.js","./Icon.vue.e15b8911.js","./Button.vue.a83cab3b.js","./index.f2e6837c.js","./debounce.dbc9bf77.js","./toNumber.7aa6a805.js","./isSymbol.b9109ae5.js","./_plugin-vue_export-helper.c27b6911.js","./Button.95d2a5ed.css","./useBetaFeatureToggle.52c326cd.js","./index.5263eb1d.js","./index.2ae12d3e.js","./validation.5ed31fc1.js","./useMetas.223da623.js","./index.6f605a00.js","./FormItem.fe59dafe.js","./identity.b813b76e.js","./_getPrototype.00be30f0.js","./Col.23d910dc.js","./responsiveObserve.9209e727.js","./toArray.f6fa5a71.js","./FormItemContext.27b2e5db.js","./useSize.dec45296.js","./_flatRest.037bf8e3.js","./isPlainObject.4c0f42f1.js","./index.a8ef1b7e.js","./Input.16966097.js","./antInputDirective.8ac36ea7.js","./SearchOutlined.c1eed30a.js","./TextArea.1bd4034f.js","./Password.d7b16461.js","./index.2660048d.js","./Checkbox.65681aa3.js","./createForOfIteratorHelper.37be2624.js","./index.4385a501.js","./isMobile.e2e89480.js","./useMemo.4991ab9d.js","./useMergedState.1cc2a884.js","./useState.a6853ebd.js","./DownOutlined.9cfe3e0c.js","./CheckOutlined.80115d65.js","./EditOrAddProvider.44ca9c5b.css","./virtualCell.88c63e03.js","./index.e7cf7635.js","./index.82f05b6c.js","./Dropdown.a78be736.js","./RightOutlined.2c092523.js","./VirtualCell.23f24363.css"],import.meta.url).then(a=>a.default||a)),At=c(()=>p(()=>import("./Cell.80a8ff87.js"),["./Cell.80a8ff87.js","./entry.13466615.js","./entry.0f786d51.css","./CellIcon.8e3c7692.js","./index.5263eb1d.js","./cell.b6c2deed.js","./useMetas.223da623.js","./EditOrAddProvider.vue.9fbafb18.js","./Icon.vue.e15b8911.js","./Button.vue.a83cab3b.js","./index.f2e6837c.js","./debounce.dbc9bf77.js","./toNumber.7aa6a805.js","./isSymbol.b9109ae5.js","./_plugin-vue_export-helper.c27b6911.js","./Button.95d2a5ed.css","./useBetaFeatureToggle.52c326cd.js","./index.2ae12d3e.js","./validation.5ed31fc1.js","./index.6f605a00.js","./FormItem.fe59dafe.js","./identity.b813b76e.js","./_getPrototype.00be30f0.js","./Col.23d910dc.js","./responsiveObserve.9209e727.js","./toArray.f6fa5a71.js","./FormItemContext.27b2e5db.js","./useSize.dec45296.js","./_flatRest.037bf8e3.js","./isPlainObject.4c0f42f1.js","./index.a8ef1b7e.js","./Input.16966097.js","./antInputDirective.8ac36ea7.js","./SearchOutlined.c1eed30a.js","./TextArea.1bd4034f.js","./Password.d7b16461.js","./index.2660048d.js","./Checkbox.65681aa3.js","./createForOfIteratorHelper.37be2624.js","./index.4385a501.js","./isMobile.e2e89480.js","./useMemo.4991ab9d.js","./useMergedState.1cc2a884.js","./useState.a6853ebd.js","./DownOutlined.9cfe3e0c.js","./CheckOutlined.80115d65.js","./EditOrAddProvider.44ca9c5b.css","./index.e7cf7635.js","./index.82f05b6c.js","./Dropdown.a78be736.js","./RightOutlined.2c092523.js","./Cell.c77dfd55.css"],import.meta.url).then(a=>a.default||a)),ht=c(()=>p(()=>import("./VirtualCell.6403155c.js"),["./VirtualCell.6403155c.js","./entry.13466615.js","./entry.0f786d51.css","./index.5263eb1d.js","./virtualCell.88c63e03.js"],import.meta.url).then(a=>a.default||a)),xt=c(()=>p(()=>import("./Cell.2ddf952b.js"),["./Cell.2ddf952b.js","./entry.13466615.js","./entry.0f786d51.css","./index.5263eb1d.js","./cell.b6c2deed.js","./useMetas.223da623.js","./useSmartsheetRowStore.ef2cd001.js","./deepCompare.d32ec333.js","./dataUtils.31dbfaee.js","./virtualCell.88c63e03.js","./index.2a3da6a9.js","./_plugin-vue_export-helper.c27b6911.js","./Cell.69966cf7.css"],import.meta.url).then(a=>a.default||a)),kt=c(()=>p(()=>import("./Row.97af767f.js"),["./Row.97af767f.js","./index.5263eb1d.js","./useSmartsheetRowStore.ef2cd001.js","./entry.13466615.js","./entry.0f786d51.css","./deepCompare.d32ec333.js","./dataUtils.31dbfaee.js","./virtualCell.88c63e03.js","./index.2a3da6a9.js","./useMetas.223da623.js","./useSmartsheetStore.9bdf3b91.js","./views.3cd4bcb9.js","./useSharedView.746b4f21.js"],import.meta.url).then(a=>a.default||a)),It=c(()=>p(()=>import("./Pagination.f0b1c53c.js"),["./Pagination.f0b1c53c.js","./entry.13466615.js","./entry.0f786d51.css","./index.5263eb1d.js","./sidebar.42429978.js","./views.3cd4bcb9.js","./useMetas.223da623.js","./useSharedView.746b4f21.js","./index.a8ef1b7e.js","./Input.16966097.js","./antInputDirective.8ac36ea7.js","./FormItemContext.27b2e5db.js","./SearchOutlined.c1eed30a.js","./isPlainObject.4c0f42f1.js","./_getPrototype.00be30f0.js","./TextArea.1bd4034f.js","./Password.d7b16461.js","./index.bc4f5185.js","./LeftOutlined.b2689280.js","./RightOutlined.2c092523.js","./index.4385a501.js","./toArray.f6fa5a71.js","./isMobile.e2e89480.js","./useMemo.4991ab9d.js","./useMergedState.1cc2a884.js","./useState.a6853ebd.js","./DownOutlined.9cfe3e0c.js","./CheckOutlined.80115d65.js","./useBreakpoint.66a79637.js","./responsiveObserve.9209e727.js","./_plugin-vue_export-helper.c27b6911.js","./Pagination.9d252b04.css"],import.meta.url).then(a=>a.default||a)),Rt=c(()=>p(()=>import("./index.90510877.js").then(a=>a.i),["./index.90510877.js","./entry.13466615.js","./entry.0f786d51.css","./TableIcon.vue.95089890.js","./Button.vue.a83cab3b.js","./index.f2e6837c.js","./debounce.dbc9bf77.js","./toNumber.7aa6a805.js","./isSymbol.b9109ae5.js","./_plugin-vue_export-helper.c27b6911.js","./Button.95d2a5ed.css","./Modal.vue.fe6a4790.js","./DeleteModal.7ab6f524.css","./useDashboard.34dd8f64.js","./useViewData.c2e6f1c7.js","./useMetas.223da623.js","./virtualCell.88c63e03.js","./dataUtils.31dbfaee.js","./index.5263eb1d.js","./useSharedView.746b4f21.js","./useSmartsheetStore.9bdf3b91.js","./views.3cd4bcb9.js","./index.2a3da6a9.js","./index.e7cf7635.js","./useCopy.a0671815.js","./useKanbanViewStore.d73f4042.js","./deepCompare.d32ec333.js","./useSmartsheetRowStore.ef2cd001.js","./index.82f05b6c.js","./Dropdown.a78be736.js","./RightOutlined.2c092523.js","./Icon.vue.e15b8911.js","./index.a6329415.js","./chevron-down.166de573.js","./index.44870401.js","./index.883a1693.css"],import.meta.url).then(a=>a.default||a)),U=a=>(Qe("data-v-33d1e501"),a=a(),$e(),a),Ct={class:"nc-project-menu-item"},Dt={class:"nc-project-menu-item"},Vt={key:0,class:"flex flex-col h-full"},Et={class:"flex flex-row p-3 !pr-1 gap-x-2 flex-wrap gap-y-2"},bt={key:1,class:"nc-gallery-container grid gap-2 my-4 px-3"},Pt=U(()=>_("a",null,[_("div",{class:"pt-[12px]"},[_("div")])],-1)),St=U(()=>_("div",{style:{"z-index":"1"}},null,-1)),zt=U(()=>_("div",{style:{"z-index":"1"}},null,-1)),Lt={key:1,class:"h-52 w-full !flex flex-row items-center justify-center"},Ut=U(()=>_("img",{class:"object-contain w-[48px] h-[48px]",src:yt},null,-1)),jt=[Ut],Bt={key:0,class:"flex flex-col space-y-1 px-4 mb-6 bg-gray-50 rounded-lg w-full"},Ft={class:"flex flex-row w-full justify-start border-b-1 border-gray-100 py-2.5"},Tt={class:"w-full text-gray-600"},Mt={class:"flex flex-row w-full pb-3 pt-2 pl-2 items-center justify-start"},Ot=Pe({__name:"Gallery",setup(a){const v=f(We,m()),R=f(Ke,m()),j=f(Ze),C=f(Xe),D=f(et,Se()),{isViewDataLoading:V}=ze(qe()),g=m(!1),B=m(),O=m(),{loadData:Y,paginationData:F,formattedData:se,loadGalleryData:G,galleryData:T,changePage:re,addEmptyRow:ie,deleteRow:ue,navigateToSiblingRow:N}=dt(v,R);S(tt,m(!1)),S(ot,m(!0)),S(at,m(!1));const Q=f(nt,m(!1)),me=f(lt,m([])),A=Le(),$=Ue(),{getPossibleAttachmentSrc:de}=mt(),_e=k(()=>me.value.filter(o=>{var t;return o.id!==((t=T.value)==null?void 0:t.fk_cover_image_col_id)})),h=k(()=>{var o,t;return(o=v.value)!=null&&o.columnsById?v.value.columnsById[(t=T.value)==null?void 0:t.fk_cover_image_col_id]:{}}),ce=(o,t)=>{const u=o.row[t.title];return u?Array.isArray(u)&&u.length===0:!0},{isSqlView:q}=He(),{isUIAllowed:pe}=Je(),fe=k(()=>pe("xcDatatableEditable")),H=m(!1),E=k({get:()=>H.value,set:o=>{fe.value&&(H.value=o)}}),b=m(null),ve=(o,t)=>{q.value||(o.preventDefault(),t&&(b.value=t))},J=o=>{var t;try{return(t=h.value)!=null&&t.title&&o.row[h.value.title]?typeof o.row[h.value.title]=="string"?JSON.parse(o.row[h.value.title]):o.row[h.value.title]:[]}catch{return[]}},W=(o,t)=>{if(Q.value)return;const u=rt(o.row,v.value.columns);u?$.push({query:{...A.query,rowId:u}}):(B.value=o,O.value=t,g.value=!0)},ye=async(o,t)=>{const u=o.target;u&&!u.closest(".gallery-carousel")&&W(t)};D==null||D.on(async()=>{const o=await ie();W(o)});const P=k({get(){return!!A.query.rowId},set(o){o||$.push({query:{...A.query,rowId:void 0}})}}),M=m(!1);return j==null||j.on(async()=>{await G(),M.value=!0,je(()=>{M.value=!1})}),C==null||C.on(async()=>{await Y()}),S(st,C),Be(R,async o=>{V.value=!0;try{(o==null?void 0:o.type)===Fe.GALLERY&&(await Y(),await G())}finally{V.value=!1}},{immediate:!0}),(o,t)=>{const u=Ge,we=Ne,ge=ft,Ae=wt,he=_t,xe=gt,ke=At,Ie=ht,Re=xt,Ce=ct,De=kt,Ve=pt,Ee=It,K=Rt,Z=Te("e");return l(),r(w,null,[I(Ve,{visible:e(E),"onUpdate:visible":t[3]||(t[3]=n=>L(E)?E.value=n:null),trigger:e(q)?[]:["contextmenu"],"overlay-class-name":"nc-dropdown-grid-context-menu"},{overlay:i(()=>[I(we,{class:"shadow !rounded !py-0",onClick:t[2]||(t[2]=n=>E.value=!1)},{default:i(()=>[e(b)?(l(),d(u,{key:0,onClick:t[0]||(t[0]=n=>e(ue)(e(b).row))},{default:i(()=>[ee((l(),r("div",Ct,[te(oe(o.$t("activity.deleteRow")),1)])),[[Z,["a:row:delete"]]])]),_:1})):y("",!0),e(b)?(l(),d(u,{key:1,onClick:t[1]||(t[1]=n=>e(D).trigger())},{default:i(()=>[ee((l(),r("div",Dt,[te(oe(o.$t("activity.insertRow")),1)])),[[Z,["a:row:insert"]]])]),_:1})):y("",!0)]),_:1})]),default:i(()=>[_("div",{class:Me(["flex flex-col w-full nc-gallery nc-scrollbar-md",{"!overflow-hidden":e(V)}]),"data-testid":"nc-gallery-wrapper",style:{height:"calc(100% - var(--topbar-height) + 0.7rem)"}},[e(V)?(l(),r("div",Vt,[_("div",Et,[(l(!0),r(w,null,z(Array(20),n=>(l(),d(ge,{key:n,class:"!min-w-60.5 !h-96 !rounded-md overflow-hidden"}))),128))])])):(l(),r("div",bt,[(l(!0),r(w,null,z(e(se),(n,be)=>(l(),r("div",{key:`record-${n.row.id}`},[I(De,{row:n},{default:i(()=>{var X;return[I(Ce,{hoverable:"",class:"!rounded-lg h-full overflow-hidden break-all max-w-[450px]","data-testid":`nc-gallery-card-${n.row.id}`,style:Oe(e(Q)?{cursor:"default"}:{cursor:"pointer"}),onClick:s=>ye(s,n),onContextmenu:s=>ve(s,{row:be})},Ye({default:i(()=>[(l(!0),r(w,null,z(e(_e),s=>(l(),r("div",{key:`record-${n.row.id}-${s.id}`},[!ce(n,s)||e(ut)(s.uidt,s.colOptions)?(l(),r("div",Bt,[_("div",Ft,[_("div",Tt,[e(ae)(s)?(l(),d(xe,{key:0,column:s,"hide-menu":!0},null,8,["column"])):(l(),d(ke,{key:1,column:s,"hide-menu":!0},null,8,["column"]))])]),_("div",Mt,[e(ae)(s)?(l(),d(Ie,{key:0,modelValue:n.row[s.title],"onUpdate:modelValue":x=>n.row[s.title]=x,column:s,row:n},null,8,["modelValue","onUpdate:modelValue","column","row"])):(l(),d(Re,{key:1,modelValue:n.row[s.title],"onUpdate:modelValue":x=>n.row[s.title]=x,column:s,"edit-enabled":!1,"read-only":!0},null,8,["modelValue","onUpdate:modelValue","column"]))])])):y("",!0)]))),128))]),_:2},[(X=e(T))!=null&&X.fk_cover_image_col_id?{name:"cover",fn:i(()=>[!e(M)&&J(n).length?(l(),d(he,{key:0,autoplay:"",class:"gallery-carousel",arrows:""},{customPaging:i(()=>[Pt]),prevArrow:i(()=>[St]),nextArrow:i(()=>[zt]),default:i(()=>[(l(!0),r(w,null,z(J(n),(s,x)=>(l(),r(w,null,[e(it)(s.title,s.mimetype??s.type)?(l(),d(Ae,{key:`carousel-${n.row.id}-${x}`,class:"h-52 object-contain",srcs:e(de)(s)},null,8,["srcs"])):y("",!0)],64))),256))]),_:2},1024)):(l(),r("div",Lt,jt))]),key:"0"}:void 0]),1032,["data-testid","style","onClick","onContextmenu"])]}),_:2},1032,["row"])]))),128))]))],2)]),_:1},8,["visible","trigger"]),I(Ee,{"pagination-data":e(F),"onUpdate:paginationData":t[4]||(t[4]=n=>L(F)?F.value=n:null),"change-page":e(re)},null,8,["pagination-data","change-page"]),(l(),d(ne,null,{default:i(()=>[e(B)&&e(g)?(l(),d(K,{key:0,modelValue:e(g),"onUpdate:modelValue":t[5]||(t[5]=n=>L(g)?g.value=n:null),row:e(B),state:e(O),meta:e(v),view:e(R)},null,8,["modelValue","row","state","meta","view"])):y("",!0)]),_:1})),(l(),d(ne,null,{default:i(()=>[e(P)?(l(),d(K,{key:e(A).query.rowId,modelValue:e(P),"onUpdate:modelValue":t[6]||(t[6]=n=>L(P)?P.value=n:null),row:{row:{},oldRow:{},rowMeta:{}},meta:e(v),"row-id":e(A).query.rowId,view:e(R),"show-next-prev-icons":"",onNext:t[7]||(t[7]=n=>e(N)(e(le).NEXT)),onPrev:t[8]||(t[8]=n=>e(N)(e(le).PREV))},null,8,["modelValue","meta","row-id","view"])):y("",!0)]),_:1}))],64)}}});const Co=vt(Ot,[["__scopeId","data-v-33d1e501"]]);export{Co as default};
