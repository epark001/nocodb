import{_ as dt}from"./nuxt-link.d273ea3b.js";import{_ as U}from"./Icon.vue.e15b8911.js";import{ch as ut,r as b,z as pt,S as W,aq as Y,fx as mt,h as $,al as C,o as s,c as y,a as o,I as P,E as t,V as N,t as x,cx as ft,W as A,b as u,w as l,C as v,cF as B,M as Q,N as X,p as H,e as J,g as vt,d as g,y as tt,i as D,fy as a,n as Z,cb as ht,aj as M,cp as Et,k as yt,c4 as xt,A as gt,ck as wt,ap as It,cI as $t,aV as q,fz as kt,fw as At}from"./entry.13466615.js";import{D as K}from"./index.82f05b6c.js";import{_ as L}from"./_plugin-vue_export-helper.c27b6911.js";import{_ as Tt}from"./ProjectIcon.05001560.js";import{K as bt,u as Ct}from"./v3-infinite-loading.e93e94ab.js";import{S as Rt}from"./index.f2e6837c.js";import{_ as Wt}from"./index.1669d181.js";import{e as Dt}from"./useMetas.223da623.js";import{_ as St}from"./nocodb-full.cd15034a.js";import{b as Nt,L as Pt,_ as Lt}from"./index.a0a88763.js";import"./Dropdown.a78be736.js";import"./RightOutlined.2c092523.js";import"./debounce.dbc9bf77.js";import"./toNumber.7aa6a805.js";import"./isSymbol.b9109ae5.js";import"./isNumeric.3f69e2aa.js";import"./LeftOutlined.b2689280.js";const V=ut("notificationStore",()=>{const n=b([]),c=b(!1),e=b(),i=b(0),d=b(!1),{api:r,isLoading:_}=pt(),{appInfo:h,token:m}=W();let f;const k=E=>{const I=new URL(h.value.ncSiteUrl,window.location.href.split(/[?#]/)[0]).href;f=mt(`${I}${I.endsWith("/")?"":"/"}notifications`,{extraHeaders:{"xc-auth":E}}),f.on("notification",O=>{n.value=[O,...n.value],e.value.totalRows+=1,i.value+=1,c.value=!1}),f.emit("subscribe",{})};Y(()=>m.value,(E,I)=>{E&&E!==I?k(E):E||f==null||f.disconnect()},{immediate:!0});const w=async(E=!1)=>{const I=await r.notification.list({is_read:d.value,limit:10,offset:E?n.value.length:0});E?n.value=[...n.value,...I.list]:n.value=I.list,e.value=I.pageInfo,i.value=I.unreadCount};return{notifications:n,loadNotifications:w,isLoading:_,isRead:d,pageInfo:e,markAsRead:async E=>{E.is_read||(await r.notification.update(E.id,{is_read:!0}),E.is_read=!0)},markAllAsRead:async E=>{E.is_read||(await r.notification.markAllAsRead(),await w())},unreadCount:i,isOpened:c,markAsOpened:async()=>{c.value=!0}}}),et=n=>(H("data-v-18cfde23"),n=n(),J(),n),Vt={class:"nc-avatar-wrapper"},jt=et(()=>o("div",{class:"nc-notification-avatar"},null,-1)),Ot={class:"flex-grow ml-3"},Mt={class:"flex items-center"},Bt=et(()=>o("div",{class:"p-2 text-xs"},"Mark as read",-1)),Ut=$({__name:"Wrapper",props:{item:{}},setup(n){const e=C(n,"item"),i=V(),{markAsRead:d}=i;return(r,_)=>{const h=U,m=Q,f=X,k=K;return s(),y("div",{class:P(["flex items-center gap-1 cursor-pointer nc-notification-item-wrapper",{active:!t(e).is_read}])},[o("div",{class:P(["nc-notification-dot",{active:!t(e).is_read}])},null,2),o("div",Vt,[N(r.$slots,"avatar",{},()=>[jt],!0)]),o("div",Ot,[o("div",Mt,[N(r.$slots,"default",{},void 0,!0)]),t(e)?(s(),y("div",{key:0,class:P(["text-xs text-gray-500 mt-1",{"text-primary":!t(e).is_read}])},x(t(ft)(t(e).created_at)),3)):A("",!0)]),o("div",{onClick:_[1]||(_[1]=B(()=>{},["stop"]))},[u(k,null,{overlay:l(()=>[u(f,null,{default:l(()=>[u(m,{onClick:_[0]||(_[0]=w=>t(d)(t(e)))},{default:l(()=>[Bt]),_:1})]),_:1})]),default:l(()=>[t(e).is_read?A("",!0):(s(),v(h,{key:0,icon:"threeDotVertical",class:"nc-notification-menu-icon"}))]),_:1})])],2)}}});const S=L(Ut,[["__scopeId","data-v-18cfde23"]]),Ht=""+new URL("64x64.a9fe41ab.png",import.meta.url).href,Jt=o("img",{src:Ht,class:"w-6"},null,-1),Kt=o("div",{class:"text-xs"},[g("Welcome to "),o("strong",null,"NocoHUB!"),g(" We’re excited to have you onboard.")],-1),Gt=$({__name:"Welcome",props:{item:{}},setup(n){const c=n,i=vt().currentRoute,d=C(c,"item"),r=()=>{i.value.path!=="/"&&tt("/")};return(_,h)=>{const m=S;return s(),v(m,{item:t(d),onClick:r},{avatar:l(()=>[Jt]),default:l(()=>[Kt]),_:1},8,["item"])}}}),zt={class:"text-xs"},Ft=$({__name:"ProjectInvite",props:{item:{}},setup(n){const c=n,{navigateToProject:e}=W(),i=C(c,"item");return(d,r)=>{const _=S;return s(),v(_,{item:t(i),onClick:r[0]||(r[0]=h=>t(e)({projectId:t(i).body.id}))},{default:l(()=>[o("div",zt,[o("strong",null,x(t(i).body.invited_by),1),g(" has invited you to collaborate on ")])]),_:1},8,["item"])}}}),Zt={class:"text-xs gap-2"},qt=$({__name:"ProjectEvent",props:{item:{}},setup(n){const e=C(n,"item"),{navigateToProject:i}=W(),d=D(()=>{switch(e.value.type){case a.PROJECT_CREATE:return"created";case a.PROJECT_UPDATE:return"updated";case a.PROJECT_DELETE:return"deleted"}}),r=()=>{e.value.type!==a.PROJECT_DELETE&&i({projectId:e.value.body.id})};return(_,h)=>{const m=Tt,f=S;return s(),v(f,{item:t(e),onClick:r},{default:l(()=>[o("div",Zt,[g(" Project "),u(m,{style:{"vertical-align":"middle"},type:t(e).body.type},null,8,["type"]),g(),o("strong",null,x(t(e).body.title),1),g(" "+x(t(d))+" successfully ",1)])]),_:1},8,["item"])}}}),Yt={class:"text-xs gap-2"},Qt=$({__name:"TableEvent",props:{item:{}},setup(n){const e=C(n,"item"),{navigateToProject:i}=W(),d=D(()=>{switch(e.value.type){case a.TABLE_CREATE:return"created";case a.TABLE_UPDATE:return"updated";case a.TABLE_DELETE:return"deleted"}}),r=()=>{e.value.type!==a.TABLE_DELETE&&i({projectId:e.value.body.id})};return(_,h)=>{const m=S;return s(),v(m,{item:t(e),onClick:r},{default:l(()=>[o("div",Yt,[g(" Table "),o("strong",null,x(t(e).body.title),1),g(" "+x(t(d))+" successfully ",1)])]),_:1},8,["item"])}}}),Xt={class:"text-xs gap-2"},te=$({__name:"ViewEvent",props:{item:{}},setup(n){const e=C(n,"item"),{navigateToProject:i}=W(),d=D(()=>{switch(e.value.type){case a.VIEW_CREATE:return"created";case a.VIEW_UPDATE:return"updated";case a.VIEW_DELETE:return"deleted"}}),r=()=>{e.value.type!==a.VIEW_DELETE&&i({projectId:e.value.body.id})};return(_,h)=>{const m=S;return s(),v(m,{item:t(e),onClick:r},{default:l(()=>[o("div",Xt,[g(" View "),o("strong",null,x(t(e).body.title),1),g(" "+x(t(d))+" successfully ",1)])]),_:1},8,["item"])}}}),ee={class:"text-xs gap-2"},oe=$({__name:"SharedViewEvent",props:{item:{}},setup(n){const e=C(n,"item"),{navigateToProject:i}=W(),d=D(()=>{switch(e.value.type){case a.VIEW_CREATE:return"created";case a.VIEW_UPDATE:return"updated";case a.VIEW_DELETE:return"deleted"}}),r=()=>{e.value.type!==a.VIEW_DELETE&&i({projectId:e.value.body.id})};return(_,h)=>{const m=S;return s(),v(m,{item:t(e),onClick:r},{default:l(()=>[o("div",ee,[g(" Shared view "),o("strong",null,x(t(e).body.title),1),g(" "+x(t(d))+" successfully ",1)])]),_:1},8,["item"])}}}),ne={key:8},se=$({__name:"Item",props:{item:{}},setup(n){const e=C(n,"item"),i=V(),{markAsRead:d}=i;return(r,_)=>{const h=Gt,m=Ft,f=Z("NotificationItemWorkspaceInvite"),k=qt,w=Qt,R=te,T=oe,p=Z("NotificationItemWorkspaceEvent");return s(),y("div",{class:"select-none",onClick:_[0]||(_[0]=E=>t(d)(t(e)))},[t(e).type===t(a).WELCOME?(s(),v(h,{key:0,item:t(e)},null,8,["item"])):t(e).type===t(a).PROJECT_INVITE?(s(),v(m,{key:1,item:t(e)},null,8,["item"])):t(e).type===t(a).WORKSPACE_INVITE?(s(),v(f,{key:2,item:t(e)},null,8,["item"])):[t(a).PROJECT_CREATE,t(a).PROJECT_DELETE,t(a).PROJECT_UPDATE].includes(t(e).type)?(s(),v(k,{key:3,item:t(e)},null,8,["item"])):[t(a).TABLE_CREATE,t(a).TABLE_DELETE,t(a).TABLE_UPDATE].includes(t(e).type)?(s(),v(w,{key:4,item:t(e)},null,8,["item"])):[t(a).VIEW_CREATE,t(a).VIEW_DELETE,t(a).VIEW_UPDATE].includes(t(e).type)?(s(),v(R,{key:5,item:t(e)},null,8,["item"])):[t(a).SHARED_VIEW_CREATE,t(a).SHARED_VIEW_DELETE,t(a).SHARED_VIEW_UPDATE].includes(t(e).type)?(s(),v(T,{key:6,item:t(e)},null,8,["item"])):[t(a).WORKSPACE_CREATE,t(a).WORKSPACE_DELETE,t(a).WORKSPACE_UPDATE].includes(t(e).type)?(s(),v(p,{key:7,item:t(e)},null,8,["item"])):(s(),y("span",ne))])}}}),j=n=>(H("data-v-bf4945f9"),n=n(),J(),n),ae={class:"min-w-[350px] max-w-[350px] min-h-[400px] !rounded-2xl bg-white rounded-xl nc-card"},ce={class:"flex items-center"},ie=j(()=>o("span",{class:"text-md font-medium text-[#212121]"}," Notification ",-1)),re=j(()=>o("div",{class:"flex-grow"},null,-1)),_e={key:0,class:"flex flex-col gap-2 items-center justify-center"},le=j(()=>o("div",{class:"text-sm text-gray-400"},"You have no new notifications",-1)),de={class:"flex flex-row w-full justify-center mt-2"},ue=j(()=>o("span",null,null,-1)),pe=$({__name:"Card",setup(n){const c=V(),{notifications:e,isRead:i,pageInfo:d}=ht(c);return(r,_)=>{var w,R,T;const h=Wt,m=U,f=se,k=Rt;return s(),y("div",ae,[o("div",{class:"p-3",onClick:_[1]||(_[1]=B(()=>{},["stop"]))},[o("div",ce,[ie,re,!t(i)&&((w=t(e))!=null&&w.length)?(s(),y("div",{key:0,class:"cursor-pointer text-xs text-gray-500 hover:text-primary",onClick:_[0]||(_[0]=B((...p)=>t(c).markAllAsRead&&t(c).markAllAsRead(...p),["stop"]))}," Mark all as read ")):A("",!0)])]),u(h,{class:"!my-0"}),o("div",{class:P(["overflow-y-auto max-h-[max(60vh,500px)] min-h-100",{"flex items-center justify-center":!((R=t(e))!=null&&R.length)}])},[(T=t(e))!=null&&T.length?(s(),y(M,{key:1},[(s(!0),y(M,null,Et(t(e),p=>(s(),y(M,{key:p.id},[u(f,{class:"",item:p},null,8,["item"]),u(h,{class:"!my-0"})],64))),128)),t(e)&&t(d)&&t(d).totalRows>t(e).length?(s(),v(t(bt),{key:0,onInfinite:_[2]||(_[2]=p=>t(c).loadNotifications(!0))},{spinner:l(()=>[o("div",de,[u(k)])]),complete:l(()=>[ue]),_:1})):A("",!0)],64)):(s(),y("div",_e,[le,u(m,{icon:"inbox",class:"!text-40px text-gray-400"})]))],2)])}}});const me=L(pe,[["__scopeId","data-v-bf4945f9"]]),fe={class:"cursor-pointer flex items-center"},ve={class:"relative leading-none"},he={key:0,class:"nc-count-badge"},Ee=$({__name:"Menu",setup(n){const c=V(),{loadNotifications:e,markAsOpened:i}=c;yt(async()=>{await e()});const d=r=>{r&&i()};return(r,_)=>{const h=U,m=me,f=K;return s(),y("div",fe,[u(f,{trigger:["click"],onVisibleChange:d},{overlay:l(()=>[u(m)]),default:l(()=>[o("div",ve,[u(h,{icon:"notification"}),u(h,{icon:"menuDown"}),!t(c).isOpened&&t(c).unreadCount?(s(),y("span",he,x(t(c).unreadCount),1)):A("",!0)])]),_:1})])}}});const ye=L(Ee,[["__scopeId","data-v-e442a77a"]]),xe={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ge=o("path",{fill:"currentColor",d:"m17 8l-1.4 1.4l1.6 1.6H9v2h8.2l-1.6 1.6L17 16l4-4l-4-4M5 5h7V3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h7v-2H5V5Z"},null,-1),we=[ge];function Ie(n,c){return s(),y("svg",xe,we)}const $e={name:"mdi-logout",render:Ie},ke={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ae=o("path",{fill:"currentColor",d:"M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10a10 10 0 0 0 10-10A10 10 0 0 0 12 2M7.07 18.28c.43-.9 3.05-1.78 4.93-1.78s4.5.88 4.93 1.78A7.893 7.893 0 0 1 12 20c-1.86 0-3.57-.64-4.93-1.72m11.29-1.45c-1.43-1.74-4.9-2.33-6.36-2.33s-4.93.59-6.36 2.33A7.928 7.928 0 0 1 4 12c0-4.41 3.59-8 8-8s8 3.59 8 8c0 1.82-.62 3.5-1.64 4.83M12 6c-1.94 0-3.5 1.56-3.5 3.5S10.06 13 12 13s3.5-1.56 3.5-3.5S13.94 6 12 6m0 5a1.5 1.5 0 0 1-1.5-1.5A1.5 1.5 0 0 1 12 8a1.5 1.5 0 0 1 1.5 1.5A1.5 1.5 0 0 1 12 11Z"},null,-1),Te=[Ae];function be(n,c){return s(),y("svg",ke,Te)}const Ce={name:"mdi-account-circle-outline",render:be},ot=n=>(H("data-v-d6f3fa06"),n=n(),J(),n),Re={class:"flex w-full h-full items-center nc-header-content"},We={class:"flex-1 min-w-0 w-50"},De=ot(()=>o("img",{src:St,class:"h-11"},null,-1)),Se={key:0,class:"flex gap-1"},Ne={class:"flex-1 min-w-0 flex justify-end gap-2"},Pe={class:"flex flex-row flex-grow"},Le={key:0,class:"flex items-center"},Ve={class:"flex items-center gap-1 cursor-pointer","data-testid":"nc-ws-account-menu-dropdown"},je={class:"h-8.5 w-8.5 rounded-full text-xs bg-secondary flex items-center justify-center font-weight-bold text-black uppercase"},Oe={class:"prose group-hover:text-primary"},Me=ot(()=>o("div",null,"Account",-1)),Be={class:"text-xs text-gray-500"},Ue={class:"prose group-hover:text-primary"},He={class:"w-full h-[calc(100vh_-_var(--new-header-height))]"},Je={name:"DefaultLayout"},Ke=$({...Je,setup(n){var T;const c=xt();Ct();const{te:e,t:i}=gt(),d=b(!0),r=b(!0),{signOut:_,user:h}=W(),{clearWorkspaces:m}=Dt(),f=D(()=>{var p;return((p=h.value)==null?void 0:p.email)??"---"}),k=b(!1);wt((T=c.meta)!=null&&T.title&&e(c.meta.title)?`${i(c.meta.title)}`:"NocoDB");const w=D(()=>{var p;return(p=c.meta)==null?void 0:p.public});Y(d,p=>{p||(k.value=!0,It(()=>{k.value=!1}))});const R=async()=>{await _(!1),await tt("/signin"),await m()};return(p,E)=>{const I=dt,O=ye,nt=kt,st=Ce,G=Q,at=At,ct=$e,it=X,rt=K,_t=Nt,lt=Pt,z=Lt,F=$t("e");return s(),v(z,null,{default:l(()=>[u(_t,{class:"max-h-[var(--new-header-height)] !px-2"},{default:l(()=>[o("div",Re,[o("div",We,[u(I,{to:t(w)?"":"/"},{default:l(()=>[De]),_:1},8,["to"])]),p.$route.name==="index-index"?(s(),y("div",Se)):A("",!0),o("div",Ne,[o("div",Pe,[N(p.$slots,"navbar",{},void 0,!0)]),t(w)?A("",!0):(s(),y("div",Le,[u(O,{class:"mr-2","data-testid":"nc-notification-bell-icon"})])),t(w)?A("",!0):(s(),v(rt,{key:1,trigger:["click"],"overlay-class-name":"nc-dropdown-user-accounts-menu"},{overlay:l(()=>[u(it,{class:"!py-0 leading-8 !rounded min-w-40"},{default:l(()=>[u(G,{key:"0","data-testid":"nc-menu-accounts__user-settings",class:"!rounded-t"},{default:l(()=>[q((s(),v(I,{class:"nc-project-menu-item group !no-underline",to:"/account/users"},{default:l(()=>[u(st,{class:"mt-1 group-hover:text-accent"}),g("  "),o("div",Oe,[Me,o("div",Be,x(t(f)),1)])]),_:1})),[[F,["c:navbar:user:email"]]])]),_:1}),u(at,{class:"!m-0"}),u(G,{key:"1",class:"!rounded-b group","data-testid":"nc-menu-accounts__sign-out"},{default:l(()=>[q((s(),y("div",{class:"nc-project-menu-item group","data-testid":"nc-logout-btn",onClick:R},[u(ct,{class:"group-hover:text-accent"}),g("  "),o("span",Ue,x(p.$t("general.signOut")),1)])),[[F,["a:navbar:user:sign-out"]]])]),_:1})]),_:1})]),default:l(()=>[o("div",Ve,[o("div",je,x(t(f)?t(f).split("@")[0].slice(0,2):"A"),1),u(nt)])]),_:1}))])])]),_:3}),u(z,{class:"nc-root"},{default:l(()=>[t(d)?(s(),v(lt,{key:0,ref:"sidebar",collapsed:!t(r),width:"250","collapsed-width":"50",class:"relative shadow-md h-full z-1 nc-left-sidebar h-[calc(100vh_-_var(--new-header-height))] !shadow-none border-gray-100 border-r-1 !overflow-x-hidden",trigger:null,collapsible:"",theme:"light"},{default:l(()=>[N(p.$slots,"sidebar",{},void 0,!0)]),_:3},8,["collapsed"])):A("",!0),o("div",He,[N(p.$slots,"default",{},void 0,!0)])]),_:3})]),_:3})}}});const uo=L(Ke,[["__scopeId","data-v-d6f3fa06"]]);export{uo as default};
