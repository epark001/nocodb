import{h as C,z as U,A as $,S as F,r as q,B,o as _,c as h,a as p,t as g,b as a,w as n,bP as V,E as r,d as v,W as k,C as z,D as E,F as M,J as N,y as j,L as D}from"./entry.51f4e399.js";import{_ as S}from"./warning.6435b508.js";import{F as T}from"./index.de92142d.js";import{_ as A}from"./Password.d493e47a.js";import{_ as G}from"./FormItem.cda40628.js";import"./useSize.3b3f469f.js";import"./identity.dd5da9ba.js";import"./isSymbol.b53bd26f.js";import"./_flatRest.ff2d3d5c.js";import"./debounce.7d32c110.js";import"./toNumber.9dc54e53.js";import"./isPlainObject.ecf52d25.js";import"./_getPrototype.ec1165af.js";import"./FormItemContext.e001cd7c.js";import"./Input.7cb175ff.js";import"./antInputDirective.8ac36ea7.js";import"./Col.88cfabc0.js";import"./responsiveObserve.501a6cf9.js";import"./toArray.06afb623.js";const I={class:"mx-auto relative flex flex-col justify-start gap-2 w-full px-8 md:bg-white max-w-[900px]"},L={class:"text-xl my-4 text-left font-weight-bold"},W={key:0,class:"mx-auto mb-4 bg-red-500 text-white rounded-lg w-3/4 p-1"},J={"data-testid":"nc-user-settings-form__error",class:"flex items-center gap-2 justify-center"},O={class:"text-right"},H={class:"flex justify-center items-center gap-2"},_s=C({__name:"ResetPassword",setup(K){const{api:y,error:l}=U({useGlobalInstance:!0}),{t}=$(),{signOut:R}=F(),f=q(),s=B({currentPassword:"",password:"",passwordRepeat:""}),u={currentPassword:[{required:!0,message:t("msg.error.signUpRules.passwdRequired")}],password:[{required:!0,message:t("msg.error.signUpRules.passwdRequired")},{min:8,message:t("msg.error.signUpRules.passwdLength")}],passwordRepeat:[{required:!0,message:t("msg.error.signUpRules.passwdRequired")},{validator:(e,o)=>new Promise((c,d)=>{if(s.password===s.passwordRepeat)return c(!0);d(new Error(t("msg.error.signUpRules.passwdMismatch")))}),message:t("msg.error.signUpRules.passwdMismatch")}]},b=async()=>{f.value.validate()&&(l.value=null,await y.auth.passwordChange({currentPassword:s.currentPassword,newPassword:s.password}),N.success(t("msg.success.passwordChanged")),await R(),j("/signin"))},m=()=>{l.value&&(l.value=null)};return(e,o)=>{const c=S,d=A,w=G,P=D,x=T;return _(),h("div",I,[p("div",L,g(e.$t("activity.changePwd")),1),a(x,{ref_key:"formValidator",ref:f,"data-testid":"nc-user-settings-form",layout:"vertical",class:"change-password lg:max-w-3/4 w-full","no-style":"",model:r(s),onFinish:b},{default:n(()=>[a(V,{name:"layout"},{default:n(()=>[r(l)?(_(),h("div",W,[p("div",J,[a(c),v(" "+g(r(l)),1)])])):k("",!0)]),_:1}),a(w,{label:e.$t("placeholder.password.current"),name:"currentPassword",rules:u.currentPassword},{default:n(()=>[a(d,{value:r(s).currentPassword,"onUpdate:value":o[0]||(o[0]=i=>r(s).currentPassword=i),"data-testid":"nc-user-settings-form__current-password",size:"large",class:"password",placeholder:e.$t("placeholder.password.current"),onFocus:m},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),a(w,{label:e.$t("placeholder.password.new"),name:"password",rules:u.password},{default:n(()=>[a(d,{value:r(s).password,"onUpdate:value":o[1]||(o[1]=i=>r(s).password=i),"data-testid":"nc-user-settings-form__new-password",size:"large",class:"password",placeholder:e.$t("placeholder.password.new"),onFocus:m},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),a(w,{label:e.$t("placeholder.password.confirm"),name:"passwordRepeat",rules:u.passwordRepeat},{default:n(()=>[a(d,{value:r(s).passwordRepeat,"onUpdate:value":o[2]||(o[2]=i=>r(s).passwordRepeat=i),"data-testid":"nc-user-settings-form__new-password-repeat",size:"large",class:"password",placeholder:e.$t("placeholder.password.confirm"),onFocus:m},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),p("div",O,[a(P,{size:"middle","data-testid":"nc-user-settings-form__submit",class:"!rounded-md !h-[2.5rem]",type:"primary","html-type":"submit"},{default:n(()=>[p("div",H,[(_(),z(E(r(M).passwordChange))),v(" "+g(e.$t("activity.changePwd")),1)])]),_:1})])]),_:1},8,["model"])])}}});export{_s as default};
