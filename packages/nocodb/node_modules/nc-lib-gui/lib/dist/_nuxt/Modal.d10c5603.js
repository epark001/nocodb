import{h as pe,$ as de,r as b,gx as _e,e$ as ue,B as fe,b4 as he,o as n,C as i,w as a,a as l,E as e,c as f,b as s,d as h,W as m,t as S,H as j,I as w,aj as ve,cp as ge,D as C,F as B,cF as v,Q as ye,R as ke,aq as xe,_ as be,P as we}from"./entry.51f4e399.js";import{_ as Ce}from"./Button.vue.793bcd1d.js";import{_ as Fe}from"./Overlay.8132102a.js";import{_ as De}from"./Icon.vue.1162f18b.js";import{_ as Ie}from"./DeleteModal.vue.909e0964.js";import{d as Ae}from"./index.5263eb1d.js";import{a as $e}from"./useSmartsheetStore.1784ce8b.js";import{i as Re}from"./fileUtils.43128440.js";import{u as Ve}from"./useAttachment.c953c895.js";import{u as Me}from"./index.9e760c64.js";import{u as Se,a as je,_ as Be,b as Le,c as Oe}from"./index.96daf2ae.js";import{C as Ue}from"./index.0d6d8ba8.js";import{C as Ee}from"./index.680937e8.js";import{_ as Pe}from"./index.c7116bd2.js";import"./index.0db47614.js";import"./debounce.7d32c110.js";import"./toNumber.9dc54e53.js";import"./isSymbol.b53bd26f.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Modal.vue.b59a28af.js";import"./views.28a76d89.js";import"./useMetas.ba7abae7.js";import"./useSharedView.0db5f32b.js";import"./index.b9981e09.js";import"./urlUtils.a77f6d4a.js";import"./Tooltip.vue.f55045dc.js";import"./index.82c42c24.js";import"./useSmartsheetRowStore.aafbb4bb.js";import"./deepCompare.d32ec333.js";import"./dataUtils.edecace3.js";import"./virtualCell.4dce1393.js";import"./index.277e21b7.js";import"./index.e760d172.js";import"./Input.7cb175ff.js";import"./antInputDirective.8ac36ea7.js";import"./FormItemContext.e001cd7c.js";import"./SearchOutlined.dec109ce.js";import"./isPlainObject.ecf52d25.js";import"./_getPrototype.ec1165af.js";import"./TextArea.442a25cb.js";import"./Password.d493e47a.js";import"./index.de92142d.js";import"./FormItem.cda40628.js";import"./identity.dd5da9ba.js";import"./Col.88cfabc0.js";import"./responsiveObserve.501a6cf9.js";import"./toArray.06afb623.js";import"./useSize.3b3f469f.js";import"./_flatRest.ff2d3d5c.js";import"./sortable.esm.9c3c89c5.js";import"./Checkbox.a529f1e6.js";import"./createForOfIteratorHelper.12419aa5.js";import"./index.c4aafe5c.js";import"./Dropdown.dc69c0a4.js";import"./useState.6010d8b6.js";import"./useRefs.154aa2be.js";import"./isMobile.e2e89480.js";import"./useMergedState.5e6500b1.js";import"./index.529d8b39.js";import"./index.fbcca285.js";import"./Input.c36cd06d.js";const Ne=ye(()=>ke(()=>import("./Image.4fea8a8a.js"),["./Image.4fea8a8a.js","./entry.51f4e399.js","./entry.0f786d51.css"],import.meta.url).then(F=>F.default||F)),ze={class:"flex gap-4"},Te={class:"flex items-center gap-2"},Ze={key:0,class:"text-gray-400"},Ge={class:"font-semibold underline"},qe={key:1,class:"flex flex-1 items-center gap-3 justify-end mr-[30px]"},Ke=l("div",{class:"text-white text-3xl"},"Drop here",-1),Qe={class:"nc-attachment-download group-hover:opacity-100"},We={class:"nc-attachment-download group-hover:opacity-100 mr-[35px]"},He=["title"],Je={key:0,class:"flex flex-col gap-1"},Xe={class:"nc-attachment h-full w-full flex items-center justify-center"},Ye={class:"flex flex-row items-center py-2.25 px-2.5 bg-gray-50 rounded-lg text-gray-700 mb-4"},et={class:"capitalize text-ellipsis overflow-hidden select-none w-full pl-1.75",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},co=pe({__name:"Modal",setup(F){const{isUIAllowed:D}=Me(),{open:L,isLoading:T,isPublic:I,isReadonly:_,visibleItems:O,modalVisible:p,column:Z,FileIcon:G,removeFile:q,onDrop:U,downloadFile:K,updateModelValue:Q,selectedImage:E,selectedVisibleItems:y,bulkDownloadFiles:W,renameFile:H}=Se(),A=de(Ae,b(!1)),$=b(),P=b(),{dragging:R}=je(P,O,Q,_),{isOverDropZone:k}=_e($,U),{isSharedForm:x}=$e(),{getPossibleAttachmentSrc:J,openAttachment:N}=Ve();ue("Escape",()=>{p.value=!1,k.value=!1});function X(c){E.value=c,p.value=!1;const o=xe(E,V=>{V||(setTimeout(()=>{p.value=!0},50),o==null||o())})}const g=b(!1),u=fe({title:"",i:0});function Y(c,o){g.value=!0,u.i=o,u.title=c}he($,"paste",c=>{var o;(o=c.clipboardData)!=null&&o.files&&U(c.clipboardData.files)});const ee=c=>{q(c),g.value=!1,u.i=0,u.title=""};return(c,o)=>{const V=Be,te=Ce,oe=Le,ne=Fe,le=Ue,M=be,ae=Ne,ie=Oe,z=Ee,se=Pe,ce=De,re=Ie,me=we;return n(),i(me,{visible:e(p),"onUpdate:visible":o[3]||(o[3]=t=>j(p)?p.value=t:null),class:w(["nc-attachment-modal",{active:e(p)}]),width:"80%",footer:null,"wrap-class-name":"nc-modal-attachment-expand-cell"},{title:a(()=>{var t;return[l("div",ze,[e(x)||!e(_)&&e(D)("tableAttachment")&&!e(I)&&!e(A)?(n(),f("div",{key:0,class:"nc-attach-file group","data-testid":"attachment-expand-file-picker-button",onClick:o[0]||(o[0]=(...r)=>e(L)&&e(L)(...r))},[s(V,{class:"transform group-hover:text-accent group-hover:scale-120"}),h(" Attach File ")])):m("",!0),l("div",Te,[e(_)?(n(),f("div",Ze,"[Readonly]")):m("",!0),h(" Viewing Attachments of "),l("div",Ge,S((t=e(Z))==null?void 0:t.title),1)]),e(y).includes(!0)?(n(),f("div",qe,[s(te,{type:"primary",class:"nc-attachment-download-all",onClick:e(W)},{default:a(()=>[h(" Bulk Download ")]),_:1},8,["onClick"])])):m("",!0)])]}),default:a(()=>[l("div",{ref_key:"dropZoneRef",ref:$,tabindex:"0"},[e(x)||!e(_)&&!e(R)?(n(),i(ne,{key:0,modelValue:e(k),"onUpdate:modelValue":o[1]||(o[1]=t=>j(k)?k.value=t:null),inline:"",class:"text-white ring ring-accent ring-opacity-100 bg-gray-700/75 flex items-center justify-center gap-2 backdrop-blur-xl"},{default:a(()=>[s(oe,{class:"text-accent",height:"35",width:"35"}),Ke]),_:1},8,["modelValue"])):m("",!0),l("div",{ref_key:"sortableRef",ref:P,class:w([{dragging:e(R)},"grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-6 relative p-6"])},[(n(!0),f(ve,null,ge(e(O),(t,r)=>(n(),f("div",{key:`${t.title}-${r}`,class:"flex flex-col gap-1"},[s(z,{class:"nc-attachment-item group"},{default:a(()=>[s(le,{checked:e(y)[r],"onUpdate:checked":d=>e(y)[r]=d,class:w(["nc-attachment-checkbox group-hover:opacity-100",{"!opacity-100":e(y)[r]}])},null,8,["checked","onUpdate:checked","class"]),e(_)?m("",!0):(n(),i(M,{key:0},{title:a(()=>[h(" Remove File ")]),default:a(()=>[e(x)||e(D)("tableAttachment")&&!e(I)&&!e(A)?(n(),i(C(e(B).closeCircle),{key:0,class:"nc-attachment-remove",onClick:v(d=>Y(t.title,r),["stop"])},null,8,["onClick"])):m("",!0)]),_:2},1024)),s(M,{placement:"bottom"},{title:a(()=>[h(" Download File ")]),default:a(()=>[l("div",Qe,[(n(),i(C(e(B).download),{onClick:v(d=>e(K)(t),["stop"])},null,8,["onClick"]))])]),_:2},1024),e(x)||!e(_)&&e(D)("tableAttachment")&&!e(I)&&!e(A)?(n(),i(M,{key:1,placement:"bottom"},{title:a(()=>[h(" Rename File ")]),default:a(()=>[l("div",We,[(n(),i(C(e(B).edit),{onClick:v(d=>e(H)(t,r),["stop"])},null,8,["onClick"]))])]),_:2},1024)):m("",!0),l("div",{class:w([[e(R)?"cursor-move":"cursor-pointer"],"nc-attachment h-full w-full flex items-center justify-center overflow-hidden"])},[e(Re)(t.title,t.mimetype)?(n(),i(ae,{key:0,srcs:e(J)(t),class:"max-w-full max-h-full m-auto justify-center",onClick:v(d=>X(t),["stop"])},null,8,["srcs","onClick"])):t.icon?(n(),i(C(e(G)(t.icon)),{key:1,height:"150",width:"150",onClick:v(d=>e(N)(t),["stop"])},null,8,["onClick"])):(n(),i(ie,{key:2,height:"150",width:"150",onClick:v(d=>e(N)(t),["stop"])},null,8,["onClick"]))],2)]),_:2},1024),l("div",{class:"truncate",title:t.title},S(t.title),9,He)]))),128)),e(T)?(n(),f("div",Je,[s(z,{class:"nc-attachment-item group"},{default:a(()=>[l("div",Xe,[s(se,{class:""})])]),_:1})])):m("",!0)],2)],512),s(re,{visible:e(g),"onUpdate:visible":o[2]||(o[2]=t=>j(g)?g.value=t:null),"entity-name":"File","on-delete":()=>ee(e(u).i)},{"entity-preview":a(()=>[l("span",null,[l("div",Ye,[s(ce,{icon:"file",class:"nc-view-icon"}),l("div",et,S(e(u).title),1)])])]),_:1},8,["visible","on-delete"])]),_:1},8,["visible","class"])}}});export{co as default};
