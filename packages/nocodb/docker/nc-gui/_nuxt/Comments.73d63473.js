import{u as _e}from"./index.e7cf7635.js";import{o as s,c as a,a as i,h as fe,r as p,eI as ve,A as ye,S as xe,i as V,U as he,aq as ke,cI as H,E as t,C as r,b as y,aj as Ce,cp as be,w as m,aV as x,d as D,t as l,W as h,D as N,F as $,I as W,cF as q,b5 as we,fC as ge,cx as Ee,H as z,b6 as Ie,J as R,M as Me,N as Se,p as De,e as Ne}from"./entry.13466615.js";import{u as $e}from"./useCopy.a0671815.js";import{u as Be}from"./index.90510877.js";import{S as Ke}from"./index.3e3f609f.js";import"./index.a8ef1b7e.js";import{I as Oe}from"./Input.16966097.js";import{D as Te}from"./index.82f05b6c.js";import{C as Ae}from"./index.2660048d.js";import{_ as Fe}from"./_plugin-vue_export-helper.c27b6911.js";import"./TableIcon.vue.95089890.js";import"./Button.vue.a83cab3b.js";import"./index.f2e6837c.js";import"./debounce.dbc9bf77.js";import"./toNumber.7aa6a805.js";import"./isSymbol.b9109ae5.js";import"./Modal.vue.fe6a4790.js";import"./useDashboard.34dd8f64.js";import"./useViewData.c2e6f1c7.js";import"./useMetas.223da623.js";import"./virtualCell.88c63e03.js";import"./dataUtils.31dbfaee.js";import"./index.5263eb1d.js";import"./useSharedView.746b4f21.js";import"./useSmartsheetStore.9bdf3b91.js";import"./views.3cd4bcb9.js";import"./index.2a3da6a9.js";import"./useKanbanViewStore.d73f4042.js";import"./deepCompare.d32ec333.js";import"./useSmartsheetRowStore.ef2cd001.js";import"./Icon.vue.e15b8911.js";import"./index.a6329415.js";import"./chevron-down.166de573.js";import"./index.44870401.js";import"./Input.2c73684e.js";import"./SearchOutlined.c1eed30a.js";import"./isPlainObject.4c0f42f1.js";import"./_getPrototype.00be30f0.js";import"./TextArea.1bd4034f.js";import"./antInputDirective.8ac36ea7.js";import"./FormItemContext.27b2e5db.js";import"./Password.d7b16461.js";import"./Dropdown.a78be736.js";import"./RightOutlined.2c092523.js";import"./Checkbox.65681aa3.js";import"./createForOfIteratorHelper.37be2624.js";const Ue={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},je=i("path",{fill:"currentColor",d:"M12 3C6.5 3 2 6.58 2 11a7.218 7.218 0 0 0 2.75 5.5c0 .6-.42 2.17-2.75 4.5c2.37-.11 4.64-1 6.47-2.5c1.14.33 2.34.5 3.53.5c5.5 0 10-3.58 10-8s-4.5-8-10-8m0 14c-4.42 0-8-2.69-8-6s3.58-6 8-6s8 2.69 8 6s-3.58 6-8 6m5-5v-2h-2v2h2m-4 0v-2h-2v2h2m-4 0v-2H7v2h2Z"},null,-1),Le=[je];function Pe(u,C){return s(),a("svg",Ue,Le)}const Ve={name:"mdi-chat-processing-outline",render:Pe},k=u=>(De("data-v-b8c7c9fb"),u=u(),Ne(),u),He={class:"h-full flex flex-col w-full bg-gray-100 p-2"},We={key:1,class:"flex flex-col text-center justify-center h-full"},qe={class:"text-center text-3xl text-gray-300"},ze=k(()=>i("div",{class:"font-bold text-center my-1 text-gray-400"},"Start a conversation",-1)),Re=k(()=>i("div",{class:"text-gray-400"}," NocoDB allows you to inquire, monitor progress updates, and collaborate with your team members. ",-1)),Ye={class:"flex gap-1 text-xs"},Ge={class:"flex-1"},Je={class:"mb-1 caption edited-text text-[10px] text-gray-500"},Ze={key:0},Qe={key:1,class:"caption my-3",style:{"word-break":"break-all"}},Xe={key:2},et={class:"time text-right text-[10px] mb-0 mt-1 text-gray-500"},tt={class:"nc-project-menu-item"},ot={class:"nc-project-menu-item"},st=k(()=>i("div",{class:"border-1 my-2 w-full"},null,-1)),nt={class:"p-0"},it={class:"flex justify-center"},at=k(()=>i("span",{class:"text-[11px] text-gray-500"},null,-1)),ct={key:0,class:"shrink mt-2 flex"},rt={class:"flex items-center"},mt=fe({__name:"Comments",async setup(u){let C,B;const{loadCommentsAndLogs:K,commentsAndLogs:b,isCommentsLoading:Y,commentsOnly:w,saveComment:g,isYou:O,comment:f,updateComment:G}=Be(),v=p();[C,B]=ve(()=>K()),await C,B();const E=p(!1),{copy:J}=$e(),{t:I}=ye(),{user:Z}=xe(),{isUIAllowed:Q}=_e(),T=V(()=>Q("commentEditable")),X=p(!0),c=p(),d=p(!1),ee=e=>e==null?void 0:e.focus();function te(e){e.key==="Escape"?oe(e):e.key==="Enter"&&A(e)}function A(e){e.stopImmediatePropagation(),e.preventDefault(),se()}function oe(e){e.stopImmediatePropagation(),e.preventDefault(),F()}async function se(){!d.value||!c.value||(await G(c.value.id,{description:c.value.description}),U())}function F(){d.value&&(c.value=void 0,U())}function U(){d.value=!1,c.value=void 0}he("Enter",e=>{d.value&&A(e)});const j=p(!1),ne=V({get:()=>j.value,set:e=>{T.value&&(j.value=e)}});async function ie(e){if(e)try{await J(e),R.success(I("msg.success.commentCopied"))}catch(n){R.error(n.message)}}function ae(e){c.value=e,d.value=!0}return ke(b,()=>{setTimeout(()=>{var e;v.value&&(v.value.scrollTop=(e=v.value)==null?void 0:e.scrollHeight)},200)},{immediate:!0}),(e,n)=>{const ce=Ke,re=Ve,L=Oe,P=Me,me=Se,le=Te,pe=Ae,ue=H("dompurify-html"),M=H("e");return s(),a("div",He,[i("div",{ref_key:"commentsWrapperEl",ref:v,class:"flex-1 min-h-[100px] overflow-y-auto scrollbar-thin-dull p-2 space-y-2"},[t(Y)?(s(),r(ce,{key:0,type:"list-item-avatar-two-line@8"})):t(b).length===0?(s(),a("div",We,[i("div",qe,[y(re)]),ze,Re])):(s(!0),a(Ce,{key:2},be(t(b),(o,de)=>(s(),a("div",{key:o.id},[y(le,{trigger:["contextmenu"],"overlay-class-name":`nc-dropdown-comment-context-menu-${de}`},{overlay:m(()=>[o.op_type==="COMMENT"?(s(),r(me,{key:0,onClick:n[2]||(n[2]=_=>ne.value=!1)},{default:m(()=>[y(P,{key:"copy-comment",onClick:_=>ie(o.description)},{default:m(()=>[x((s(),a("div",tt,[D(l(t(I)("general.copy")),1)])),[[M,["a:comment:copy"]]])]),_:2},1032,["onClick"]),o.user===t(Z).email&&!t(X)?(s(),r(P,{key:"edit-comment",onClick:_=>ae(o)},{default:m(()=>[x((s(),a("div",ot,[D(l(t(I)("general.edit")),1)])),[[M,["a:comment:edit"]]])]),_:2},1032,["onClick"])):h("",!0)]),_:2},1024)):h("",!0)]),default:m(()=>{var _;return[i("div",Ye,[(s(),r(N(t($).accountCircle),{class:W(["row-span-2",t(O)(o.user)?"text-pink-600":"text-blue-600 "])},null,8,["class"])),i("div",Ge,[i("p",Je,l(t(O)(o.user)?"You":o.user==null?"Shared base":o.user)+" "+l(o.op_type==="COMMENT"?"commented":o.op_sub_type==="INSERT"?"created":"edited"),1),o.op_type==="COMMENT"?(s(),a("div",Ze,[o.id===((_=t(c))==null?void 0:_.id)?(s(),r(L,{key:0,ref_for:!0,ref:ee,value:t(c).description,"onUpdate:value":n[0]||(n[0]=S=>t(c).description=S),onBlur:F,onKeydown:n[1]||(n[1]=q(S=>te(S),["stop"]))},null,8,["value"])):(s(),a("p",{key:1,class:"block caption my-2 nc-chip w-full min-h-20px p-2 rounded",style:we({backgroundColor:t(ge).light[2]})},l(o.description.substring(o.description.indexOf(":")+1)),5))])):o.details?x((s(),a("p",Qe,null,512)),[[ue,o.details]]):(s(),a("p",Xe,l(o.description),1)),i("p",et,l(t(Ee)(o.created_at)),1)])])]}),_:2},1032,["overlay-class-name"])]))),128))],512),st,i("div",nt,[i("div",it,[x((s(),r(pe,{checked:t(w),"onUpdate:checked":n[3]||(n[3]=o=>z(w)?w.value=o:null),onChange:t(K)},{default:m(()=>[D(l(e.$t("labels.commentsOnly"))+" ",1),at]),_:1},8,["checked","onChange"])),[[M,["c:row-expand:comment-only"]]])]),t(T)?(s(),a("div",ct,[y(L,{value:t(f),"onUpdate:value":n[4]||(n[4]=o=>z(f)?f.value=o:null),class:W(["!text-xs nc-comment-box",{focus:t(E)}]),ghost:"",onFocusin:n[5]||(n[5]=o=>E.value=!0),onFocusout:n[6]||(n[6]=o=>E.value=!1),onKeyup:Ie(q(t(g),["prevent"]),["enter"])},{addonBefore:m(()=>[i("div",rt,[(s(),r(N(t($).accountCircle),{class:"text-lg text-pink-700",small:"",onClick:t(g)},null,8,["onClick"]))])]),suffix:m(()=>[t(f)?(s(),r(N(t($).returnKey),{key:0,class:"text-sm",small:"",onClick:t(g)},null,8,["onClick"])):h("",!0)]),_:1},8,["value","class","onKeyup"])])):h("",!0)])])}}});const oo=Fe(mt,[["__scopeId","data-v-b8c7c9fb"]]);export{oo as default};
