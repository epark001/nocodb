import{cd as e,g6 as B,g7 as Pe,h as Ee,al as Ze,r as b,Z as re,ed as Xe,cb as ze,i as D,E as i,o as d,C as x,H as Le,c as g,cA as et,D as pe,I as me,cF as q,$ as ae,dg as tt,g8 as at,aq as Ce,J as be,K as he,fO as lt,f as Be,at as nt,k as st,aj as W,cp as ce,a as te,t as Q,b as de,w as N,F as xe,W as R,d as ke,V as ot,Q as ut,R as it}from"./entry.51f4e399.js";import{_ as rt}from"./Select.vue.e482f984.js";import{_ as ct}from"./Button.vue.793bcd1d.js";import{_ as dt}from"./FieldListAutoCompleteDropdown.vue.6ac3ad51.js";import{C as pt,E as mt,f as vt,h as ft,c as _t,R as qe,b as gt,M as Ge,A as We}from"./index.5263eb1d.js";import{v as Me,c as $e,d as Ae,m as Ne,l as Re,h as yt,g as bt,A as ht,n as xt,t as kt,u as Tt,s as wt,p as Dt,w as Ft,j as Vt}from"./cell.1732684e.js";import{a as He,u as Ct,f as St}from"./useMetas.ba7abae7.js";import Ot from"./SingleSelect.973aafb9.js";import je from"./MultiSelect.c752aaec.js";import Lt from"./DatePicker.ccf8ebfc.js";import Mt from"./YearPicker.e6eb7343.js";import $t from"./TimePicker.16f63c4f.js";import{_ as At}from"./Rating.vue.ff9d0360.js";import Nt from"./Duration.2333caad.js";import{_ as Rt}from"./Percent.vue.649b69a3.js";import{_ as jt}from"./Currency.vue.5d9aceaa.js";import Ie from"./Decimal.2e9d72fd.js";import Ue from"./Integer.0dc3a7a3.js";import It from"./Float.ec21e7fe.js";import{_ as Ut}from"./Text.vue.01e1d339.js";import{_ as Pt,S as Et}from"./index.5e746f62.js";import{a as Ye}from"./useSmartsheetStore.1784ce8b.js";import{u as zt}from"./useViewColumns.96f2a704.js";import{u as Bt}from"./index.9e760c64.js";import{C as qt}from"./index.0d6d8ba8.js";import{_ as Gt}from"./_plugin-vue_export-helper.c27b6911.js";const Wt=s=>Pe(s)||s===e.Time?"=":[e.SingleSelect,e.Collaborator,e.LinkToAnotherRecord,e.Date,e.DateTime].includes(s)?"is":"is equal",Ht=s=>Pe(s)||s===e.Time?"!=":[e.SingleSelect,e.Collaborator,e.LinkToAnotherRecord,e.Date,e.DateTime].includes(s)?"is not":"is not equal",Yt=s=>s===e.Attachment?"filenames contain":"is like",Qt=s=>s===e.Attachment?"filenames doesn't contain":"is not like",Jt=s=>[e.Date,e.DateTime].includes(s)?"is after":">",Kt=s=>[e.Date,e.DateTime].includes(s)?"is before":"<",Zt=s=>[e.Date,e.DateTime].includes(s)?"is on or after":">=",Xt=s=>[e.Date,e.DateTime].includes(s)?"is on or before":"<=",ve=s=>[{text:"is checked",value:"checked",ignoreVal:!0,includedTypes:[e.Checkbox]},{text:"is not checked",value:"notchecked",ignoreVal:!0,includedTypes:[e.Checkbox]},{text:Wt(s),value:"eq",ignoreVal:!1,excludedTypes:[e.Checkbox,e.MultiSelect,e.Attachment]},{text:Ht(s),value:"neq",ignoreVal:!1,excludedTypes:[e.Checkbox,e.MultiSelect,e.Attachment]},{text:Yt(s),value:"like",ignoreVal:!1,excludedTypes:[e.Checkbox,e.SingleSelect,e.MultiSelect,e.Collaborator,e.Date,e.DateTime,e.Time,...B]},{text:Qt(s),value:"nlike",ignoreVal:!1,excludedTypes:[e.Checkbox,e.SingleSelect,e.MultiSelect,e.Collaborator,e.Date,e.DateTime,e.Time,...B]},{text:"is empty",value:"empty",ignoreVal:!0,excludedTypes:[e.Checkbox,e.SingleSelect,e.MultiSelect,e.Collaborator,e.Attachment,e.LinkToAnotherRecord,e.Lookup,e.Date,e.DateTime,e.Time,...B]},{text:"is not empty",value:"notempty",ignoreVal:!0,excludedTypes:[e.Checkbox,e.SingleSelect,e.MultiSelect,e.Collaborator,e.Attachment,e.LinkToAnotherRecord,e.Lookup,e.Date,e.DateTime,e.Time,...B]},{text:"is null",value:"null",ignoreVal:!0,excludedTypes:[...B,e.Checkbox,e.SingleSelect,e.MultiSelect,e.Collaborator,e.Attachment,e.LinkToAnotherRecord,e.Lookup,e.Date,e.DateTime,e.Time]},{text:"is not null",value:"notnull",ignoreVal:!0,excludedTypes:[...B,e.Checkbox,e.SingleSelect,e.MultiSelect,e.Collaborator,e.Attachment,e.LinkToAnotherRecord,e.Lookup,e.Date,e.DateTime,e.Time]},{text:"contains all of",value:"allof",ignoreVal:!1,includedTypes:[e.MultiSelect]},{text:"contains any of",value:"anyof",ignoreVal:!1,includedTypes:[e.MultiSelect,e.SingleSelect]},{text:"does not contain all of",value:"nallof",ignoreVal:!1,includedTypes:[e.MultiSelect]},{text:"does not contain any of",value:"nanyof",ignoreVal:!1,includedTypes:[e.MultiSelect,e.SingleSelect]},{text:Jt(s),value:"gt",ignoreVal:!1,includedTypes:[...B,e.Date,e.DateTime,e.Time]},{text:Kt(s),value:"lt",ignoreVal:!1,includedTypes:[...B,e.Date,e.DateTime,e.Time]},{text:Zt(s),value:"gte",ignoreVal:!1,includedTypes:[...B,e.Date,e.DateTime,e.Time]},{text:Xt(s),value:"lte",ignoreVal:!1,includedTypes:[...B,e.Date,e.DateTime,e.Time]},{text:"is within",value:"isWithin",ignoreVal:!0,includedTypes:[e.Date,e.DateTime]},{text:"is blank",value:"blank",ignoreVal:!0,excludedTypes:[e.Checkbox,e.Links,e.Rollup]},{text:"is not blank",value:"notblank",ignoreVal:!0,excludedTypes:[e.Checkbox,e.Links,e.Rollup]}],Te=s=>s==="isWithin"?[{text:"the past week",value:"pastWeek",ignoreVal:!0,includedTypes:[e.Date,e.DateTime]},{text:"the past month",value:"pastMonth",ignoreVal:!0,includedTypes:[e.Date,e.DateTime]},{text:"the past year",value:"pastYear",ignoreVal:!0,includedTypes:[e.Date,e.DateTime]},{text:"the next week",value:"nextWeek",ignoreVal:!0,includedTypes:[e.Date,e.DateTime]},{text:"the next month",value:"nextMonth",ignoreVal:!0,includedTypes:[e.Date,e.DateTime]},{text:"the next year",value:"nextYear",ignoreVal:!0,includedTypes:[e.Date,e.DateTime]},{text:"the next number of days",value:"nextNumberOfDays",ignoreVal:!1,includedTypes:[e.Date,e.DateTime]},{text:"the past number of days",value:"pastNumberOfDays",ignoreVal:!1,includedTypes:[e.Date,e.DateTime]}]:[{text:"today",value:"today",ignoreVal:!0,includedTypes:[e.Date,e.DateTime]},{text:"tomorrow",value:"tomorrow",ignoreVal:!0,includedTypes:[e.Date,e.DateTime]},{text:"yesterday",value:"yesterday",ignoreVal:!0,includedTypes:[e.Date,e.DateTime]},{text:"one week ago",value:"oneWeekAgo",ignoreVal:!0,includedTypes:[e.Date,e.DateTime]},{text:"one week from now",value:"oneWeekFromNow",ignoreVal:!0,includedTypes:[e.Date,e.DateTime]},{text:"one month ago",value:"oneMonthAgo",ignoreVal:!0,includedTypes:[e.Date,e.DateTime]},{text:"one month from now",value:"oneMonthFromNow",ignoreVal:!0,includedTypes:[e.Date,e.DateTime]},{text:"number of days ago",value:"daysAgo",ignoreVal:!1,includedTypes:[e.Date,e.DateTime]},{text:"number of days from now",value:"daysFromNow",ignoreVal:!1,includedTypes:[e.Date,e.DateTime]},{text:"exact date",value:"exactDate",ignoreVal:!1,includedTypes:[e.Date,e.DateTime]}],ea=Ee({__name:"FilterInput",props:{column:{},filter:{}},emits:["updateFilterValue"],setup(s,{emit:S}){var X,$;const F=s,v=Ze(F,"column"),J=b(!0);re(pt,v),re(mt,Xe(J)),re(vt,b(!1));const P={isSingleSelect:bt,isMultiSelect:ht,isDate:$e,isYear:Re,isDateTime:Ae,isTime:Ne,isRating:xt,isDuration:kt,isPercent:Tt,isCurrency:wt,isDecimal:Dt,isInt:Me,isFloat:Ft,isTextArea:Vt,isLinks:l=>l.uidt===e.Links},{sqlUis:E}=ze(He()),V=b((X=v.value)!=null&&X.base_id?E.value[($=v.value)==null?void 0:$.base_id]:Object.values(E.value)[0]),C=D(()=>v.value&&V.value.getAbstractType(v.value)),K=l=>{const y=P[l];return!v.value||!y?!1:y(v.value,C)},w=D({get:()=>F.filter.value,set:l=>{S("updateFilterValue",l)}}),O=[{value:!0,label:"true"},{value:!1,label:"false"},{value:null,label:"unset"}],k=l=>["anyof","nanyof"].includes(l)?je:Ot,j=l=>["daysAgo","daysFromNow","pastNumberOfDays","nextNumberOfDays"].includes(l)?Ie:Lt,H=D(()=>({isSingleSelect:k(F.filter.comparison_op),isMultiSelect:je,isDate:j(F.filter.comparison_sub_op),isYear:Mt,isDateTime:j(F.filter.comparison_sub_op),isTime:$t,isRating:At,isDuration:Nt,isPercent:Rt,isCurrency:jt,isDecimal:Ie,isInt:Ue,isFloat:It,isLinks:Ue})),L=D(()=>Object.keys(H.value).find(l=>K(l))),Z=D(()=>{switch(L.value){case"isSingleSelect":case"isMultiSelect":return{disableOptionCreation:!0};case"isPercent":case"isDecimal":case"isFloat":case"isLinks":case"isInt":return{class:"h-32px"};case"isDuration":return{showValidationError:!1};default:return{}}}),I=D(()=>{var l;return v.value&&(((l=v.value)==null?void 0:l.uidt)===e.Links||Me(v.value,C)||$e(v.value,C)||Ae(v.value,C)||Ne(v.value,C)||Re(v.value,C))}),M=b(!1);return re(ft,b(!0)),re(_t,b(!0)),(l,y)=>{const Y=Pt;return i(v)&&i(yt)(i(v),i(C))?(d(),x(Y,{key:0,value:i(w),"onUpdate:value":y[0]||(y[0]=A=>Le(w)?w.value=A:null),disabled:l.filter.readOnly,options:O},null,8,["value","disabled"])):(d(),g("div",{key:1,class:me(["bg-white border-1 flex flex-grow min-h-32px h-full items-center",{"px-2":i(I),"border-brand-500":i(M)}]),onMouseup:y[4]||(y[4]=q(()=>{},["stop"]))},[(d(),x(pe(i(L)?i(H)[i(L)]:Ut),et({modelValue:i(w),"onUpdate:modelValue":y[1]||(y[1]=A=>Le(w)?w.value=A:null),disabled:l.filter.readOnly,placeholder:"Enter a value",column:i(v),class:"flex"},i(Z),{location:"filter",onFocus:y[2]||(y[2]=A=>M.value=!0),onBlur:y[3]||(y[3]=A=>M.value=!1)}),null,16,["modelValue","disabled","column"]))],34))}}});function ta(s,S,F,v,J,P,E){const V=b(J),C=ae(qe),{nestedFilters:K}=Ye(),{projectMeta:w}=ze(He()),O=ae(gt,b(!1)),{$api:k,$e:j}=Be(),{isUIAllowed:H}=Bt(),{metas:L}=Ct(),{addUndo:Z,clone:I,defineViewScope:M}=St(),X=b([]),$=D(()=>O.value||!H("filterSync")||!H("filterChildrenRead")),l=D({get:()=>$.value?V.value:X.value,set:a=>{if($.value){V.value=a,P&&(K.value=a),K.value=[...K.value],C==null||C.trigger();return}X.value=a}}),y=D(()=>l.value.filter(a=>a.status!=="delete")),Y=ae(Ge,b()),A=ae(We,b()),{showSystemFields:we,metaColumnById:ne}=zt(A,Y),se=D(()=>{var a,n;return(n=(a=Y.value)==null?void 0:a.columns)==null?void 0:n.filter(u=>{var p;return tt((p=ne==null?void 0:ne.value)==null?void 0:p[u.id])?we.value:u.uidt===e.QrCode||u.uidt===e.Barcode||u.uidt===e.ID||u.system?!1:!(u.colOptions&&u.system)})}),le=D(()=>{var a,n,u,p;return(n=(a=Y.value)==null?void 0:a.columns)!=null&&n.length?(p=(u=Y.value)==null?void 0:u.columns)==null?void 0:p.reduce((_,t)=>(_[t.id]=t.uidt,_),{}):{}}),G=b([]);at(l,a=>{G.value=I(a)});const oe=(a,n)=>Object.entries(n).filter(([u,p])=>a[u]!==p&&u in a).reduce((u,[p,_])=>({...u,[p]:_}),{}),ee=(a,n)=>{const u=["empty","notempty","null","notnull"].includes(n.value);return n.includedTypes?a.fk_column_id&&n.includedTypes.includes(le.value[a.fk_column_id])?u?w.value.showNullAndEmptyInFilter:!0:!1:n.excludedTypes?a.fk_column_id&&!n.excludedTypes.includes(le.value[a.fk_column_id])?u?w.value.showNullAndEmptyInFilter:!0:!1:u?w.value.showNullAndEmptyInFilter:!0},fe=(a,n)=>{if(n.includedTypes)return a.fk_column_id&&n.includedTypes.includes(le.value[a.fk_column_id]);if(n.excludedTypes)return a.fk_column_id&&!n.excludedTypes.includes(le.value[a.fk_column_id])},z=()=>{var a,n;return{comparison_op:(n=ve((a=se.value)==null?void 0:a[0].uidt).filter(u=>{var p;return ee({fk_column_id:(p=se.value)==null?void 0:p[0].id},u)}))==null?void 0:n[0].value,value:"",status:"create",logical_op:"and"}},ue=async a=>{var n;if((n=s.value)!=null&&n.id&&!$.value)try{a?S?l.value=(await k.dbTableFilter.childrenRead(S)).list:l.value=(await k.dbTableWebhookFilter.read(a)).list:S?l.value=(await k.dbTableFilter.childrenRead(S)).list:l.value=(await k.dbTableFilter.read(s.value.id)).list}catch(u){console.log(u),be.error(await he(u))}},_e=async(a,n=!1)=>{var u;try{for(const[p,_]of Object.entries(l.value))_.status==="delete"?await k.dbTableFilter.delete(_.id):_.status==="update"?await k.dbTableFilter.update(_.id,{..._,fk_parent_id:S}):_.status==="create"&&(a?l.value[+p]=await k.dbTableWebhookFilter.create(a,{..._,fk_parent_id:S}):l.value[+p]=await k.dbTableFilter.create((u=s==null?void 0:s.value)==null?void 0:u.id,{..._,fk_parent_id:S}));E||v==null||v()}catch(p){console.log(p),be.error(await he(p))}},U=async(a,n,u=!1,p=!1)=>{if(s.value){if(!p){const _=G.value[n];if(_){const t=I(oe(a,_));Object.keys(t).length>0&&Z({undo:{fn:(r,m)=>{const f=l.value[n];f&&(f[r]=m,U(f,n,u,!0))},args:[Object.keys(t)[0],Object.values(t)[0]]},redo:{fn:(r,m)=>{const f=l.value[n];f&&(f[r]=m,U(f,n,u,!0))},args:[Object.keys(t)[0],a[Object.keys(t)[0]]]},scope:M({view:A.value})})}}try{$.value?(l.value[n]={...a},l.value=[...l.value]):!(F!=null&&F.value)&&!u?a.status=a.id?"update":"create":a.id&&a.status!=="create"?(await k.dbTableFilter.update(a.id,{...a,fk_parent_id:S}),j("a:filter:update",{logical:a.logical_op,comparison:a.comparison_op})):l.value[n]=await k.dbTableFilter.create(s.value.id,{...a,fk_parent_id:S})}catch(_){console.log(_),be.error(await he(_))}G.value=I(l.value),E||v==null||v()}},ie=async(a,n,u=!1)=>{if(!u&&!a.is_group&&Z({undo:{fn:async p=>{p.status="create",l.value.splice(n,0,p),await U(p,n,!1,!0)},args:[I(a)]},redo:{fn:async p=>{await ie(l.value[p],p,!0)},args:[n]},scope:M({view:A.value})}),$.value)l.value.splice(n,1),l.value=[...l.value],E||v==null||v();else{if(a.id)if(!(F!=null&&F.value))a.status="delete";else try{await k.dbTableFilter.delete(a.id),E||v==null||v(),l.value.splice(n,1)}catch(p){console.log(p),be.error(await he(p))}else l.value.splice(n,1);j("a:filter:delete",{length:y.value.length})}},De=lt(U,500),Fe=async(a=!1)=>{l.value.push(z()),a||Z({undo:{fn:async function(u){this.redo.args=[u,I(l.value[u])],await ie(l.value[u],u,!0)},args:[l.value.length-1]},redo:{fn:async(n,u)=>{u.status="create",l.value.splice(n,0,u),await U(u,n,!1,!0)},args:[]},scope:M({view:A.value})}),G.value=I(l.value),j("a:filter:add",{length:l.value.length})},Ve=async()=>{const a=z(),n={is_group:!0,status:"create",logical_op:"and"};$.value&&(n.children=[a]),l.value.push(n);const u=l.value.length-1;await U(l.value[u],u,!0),G.value=I(l.value),j("a:filter:add",{length:l.value.length,group:!0})};return Ce(()=>{var a,n,u,p,_,t;return!(s!=null&&s.value)||!((n=L==null?void 0:L.value)!=null&&n[(a=s==null?void 0:s.value)==null?void 0:a.fk_model_id])?0:((t=(_=(p=L==null?void 0:L.value)==null?void 0:p[(u=s==null?void 0:s.value)==null?void 0:u.fk_model_id])==null?void 0:_.columns)==null?void 0:t.length)||0},async(a,n)=>{a&&a<n&&await ue()}),{filters:l,nonDeletedFilters:y,loadFilters:ue,sync:_e,deleteFilter:ie,saveOrUpdate:U,addFilter:Fe,addFilterGroup:Ve,saveOrUpdateDebounced:De,isComparisonOpAllowed:ee,isComparisonSubOpAllowed:fe}}const aa=ut(()=>it(()=>Promise.resolve().then(()=>ga),void 0,import.meta.url).then(s=>s.default||s)),la={key:0,class:"flex flex-col w-full gap-y-2"},na={class:"flex flex-row w-full justify-between items-center"},sa={key:0,class:"flex items-center ml-2"},oa={class:"capitalize"},ua={class:"flex border-1 rounded-lg p-2 w-full"},ia={key:1,class:"flex flex-row gap-x-2 w-full"},ra={key:0,class:"flex items-center ml-2 mr-7.35"},ca={class:"capitalize"},da={key:2,class:"flex flex-grow"},pa={key:6,class:"flex-grow"},ma={class:"flex items-center gap-1"},va={class:"flex items-center gap-1"},fa=Ee({__name:"ColumnFilter",props:{nestedLevel:{default:0},parentId:{default:void 0},autoSave:{type:Boolean,default:!0},hookId:{default:void 0},showLoading:{type:Boolean,default:!0},modelValue:{},webHook:{type:Boolean,default:!1}},emits:["update:filtersLength"],setup(s,{expose:S,emit:F}){const v=s,{nestedLevel:J,parentId:P,autoSave:E,hookId:V,modelValue:C,showLoading:K,webHook:w}=nt(v),O=D(()=>J.value>0),k=[{value:"and",text:"AND"},{value:"or",text:"OR"}],j=ae(Ge,b()),H=ae(We,b()),L=ae(qe),{$e:Z}=Be(),{nestedFilters:I}=Ye(),{filters:M,nonDeletedFilters:X,deleteFilter:$,saveOrUpdate:l,loadFilters:y,addFilter:Y,addFilterGroup:A,sync:we,saveOrUpdateDebounced:ne,isComparisonOpAllowed:se,isComparisonSubOpAllowed:le}=ta(H,P==null?void 0:P.value,D(()=>E.value),()=>L.trigger(K.value),C.value||I.value,!C.value,w.value),G=b(),oe=b(),ee=b(),fe=D(()=>{var t;return(t=j.value)==null?void 0:t.columns}),z=t=>{var r;return(r=fe.value)==null?void 0:r.find(m=>m.id===t.fk_column_id)},ue=b({}),_e=(t,r)=>{var m,f;return!(t.id||t.comparison_op&&((m=Te(t.comparison_op).find(h=>h.value===t.comparison_sub_op))!=null&&m.ignoreVal)||(f=ve(r.uidt).find(h=>h.value===t.comparison_op))!=null&&f.ignoreVal||t.value)},U=(t,r)=>{const m=z(t);m&&(m.uidt===e.SingleSelect&&["anyof","nanyof"].includes(ue.value[t.id])&&["eq","neq"].includes(t.comparison_op)?t.value=null:["blank","notblank","empty","notempty","null","notnull"].includes(t.comparison_op)?(t.value=null,t.comparison_sub_op=null):[e.Date,e.DateTime].includes(m.uidt)&&(t.value=null,Te(t.comparison_op).map(f=>f.value).includes(t.comparison_sub_op)||(t.comparison_op==="isWithin"?t.comparison_sub_op="pastNumberOfDays":t.comparison_sub_op="exactDate")),_e(t,m)||l(t,r),ue.value[t.id]=t.comparison_op,Z("a:filter:update",{logical:t.logical_op,comparison:t.comparison_op,comparison_sub_op:t.comparison_sub_op}))},ie=D(()=>{var t,r,m,f;return(r=(t=j.value)==null?void 0:t.columns)!=null&&r.length?(f=(m=j.value)==null?void 0:m.columns)==null?void 0:f.reduce((h,ge)=>(h[ge.id]=ge.uidt,h),{}):{}});Ce(()=>{var t;return(t=H.value)==null?void 0:t.id},(t,r)=>{!O.value&&t!==r&&(V!=null&&V.value||!w.value)&&y(V==null?void 0:V.value)}),Ce(()=>X.value.length,t=>{F("update:filtersLength",t??0)});const De=async(t,r=!1)=>{var m;if(await we(t,r),!!((m=G.value)!=null&&m.length))for(const f of G.value)f.parentId&&await f.applyChanges(t,!0)},Fe=(t,r)=>{var f;const m=z(t);m&&(t.comparison_op=(f=ve(m.uidt).find(h=>se(t,h)))==null?void 0:f.value,[e.Date,e.DateTime].includes(m.uidt)&&!["blank","notblank"].includes(t.comparison_op)?t.comparison_op==="isWithin"?t.comparison_sub_op="pastNumberOfDays":t.comparison_sub_op="exactDate":t.comparison_sub_op=null,t.value=null,_e(t,m)||l(t,r))},Ve=(t,r,m)=>{r.value=t,ne(r,m)};S({applyChanges:De,parentId:P==null?void 0:P.value});const a=()=>{var t;(t=oe.value)==null||t.scrollTo({top:oe.value.scrollHeight,behavior:"smooth"})},n=()=>{var t;O.value&&((t=ee==null?void 0:ee.value)==null||t.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"}))},u=async()=>{await Y(),O.value?n():a()},p=async()=>{await A(),O.value?n():a()},_=t=>{var r,m,f;return t.comparison_op?t.comparison_sub_op?!((r=Te(t.comparison_op).find(h=>h.value===t.comparison_sub_op))!=null&&r.ignoreVal):!((f=ve((m=z(t))==null?void 0:m.uidt).find(h=>h.value===t.comparison_op))!=null&&f.ignoreVal):!1};return st(()=>{y(V==null?void 0:V.value)}),(t,r)=>{const m=Et,f=rt,h=ct,ge=aa,Qe=dt,Je=qt,Ke=ea;return d(),g("div",{class:me(["menu-filter-dropdown",{"max-h-[max(80vh,500px)] min-w-112 py-6 pl-6":!i(O),"w-full":i(O)}])},[i(M)&&i(M).length?(d(),g("div",{key:0,ref_key:"wrapperDomRef",ref:oe,class:me(["flex flex-col gap-y-3 nc-filter-grid pb-2 w-full",{"max-h-420px nc-scrollbar-md  pr-3.5 nc-filter-top-wrapper":!i(O)}]),onClick:r[4]||(r[4]=q(()=>{},["stop"]))},[(d(!0),g(W,null,ce(i(M),(o,T)=>{var Se,Oe;return d(),g(W,{key:T},[o.status!=="delete"?(d(),g(W,{key:0},[o.is_group?(d(),g("div",la,[te("div",na,[T?(d(),g("div",{key:`${T}nested`,class:"flex nc-filter-logical-op"},[de(f,{value:o.logical_op,"onUpdate:value":c=>o.logical_op=c,"dropdown-match-select-width":!1,class:"min-w-20 capitalize",placeholder:"Group op","dropdown-class-name":"nc-dropdown-filter-logical-op-group",onClick:r[0]||(r[0]=q(()=>{},["stop"])),onChange:c=>i(l)(o,T)},{default:N(()=>[(d(),g(W,null,ce(k,c=>de(m,{key:c.value,value:c.value},{default:N(()=>[te("span",oa,Q(c.value),1)]),_:2},1032,["value"])),64))]),_:2},1032,["value","onUpdate:value","onChange"])])):(d(),g("span",sa,Q(t.$t("labels.where")),1)),o.readOnly?R("",!0):(d(),x(h,{key:T,type:"text",size:"small",class:"nc-filter-item-remove-btn cursor-pointer",onClick:q(c=>i($)(o,T),["stop"])},{default:N(()=>[(d(),x(pe(i(xe).deleteListItem)))]),_:2},1032,["onClick"]))]),te("div",ua,[o.id||o.children?(d(),x(ge,{key:o.id??T,ref_for:!0,ref_key:"localNestedFilters",ref:G,modelValue:o.children,"onUpdate:modelValue":c=>o.children=c,"nested-level":i(J)+1,"parent-id":o.id,"auto-save":i(E),"web-hook":i(w)},null,8,["modelValue","onUpdate:modelValue","nested-level","parent-id","auto-save","web-hook"])):R("",!0)])])):(d(),g("div",ia,[T?(d(),x(f,{key:1,value:o.logical_op,"onUpdate:value":c=>o.logical_op=c,"dropdown-match-select-width":!1,class:"h-full !min-w-20 !max-w-20 capitalize","hide-details":"",disabled:o.readOnly,"dropdown-class-name":"nc-dropdown-filter-logical-op",onChange:c=>U(o,T),onClick:r[1]||(r[1]=q(()=>{},["stop"]))},{default:N(()=>[(d(),g(W,null,ce(k,c=>de(m,{key:c.value,value:c.value},{default:N(()=>[te("span",ca,Q(c.value),1)]),_:2},1032,["value"])),64))]),_:2},1032,["value","onUpdate:value","disabled","onChange"])):(d(),g("span",ra,Q(t.$t("labels.where")),1)),(d(),x(Qe,{key:`${T}_6`,modelValue:o.fk_column_id,"onUpdate:modelValue":c=>o.fk_column_id=c,class:"nc-filter-field-select min-w-32 max-w-32 max-h-8",columns:i(fe),disabled:o.readOnly,onClick:r[2]||(r[2]=q(()=>{},["stop"])),onChange:c=>Fe(o,T)},null,8,["modelValue","onUpdate:modelValue","columns","disabled","onChange"])),de(f,{value:o.comparison_op,"onUpdate:value":c=>o.comparison_op=c,"dropdown-match-select-width":!1,class:"caption nc-filter-operation-select !min-w-26.75 !max-w-26.75 max-h-8",placeholder:t.$t("labels.operation"),density:"compact",variant:"solo",disabled:o.readOnly,"hide-details":"","dropdown-class-name":"nc-dropdown-filter-comp-op",onChange:c=>U(o,T)},{default:N(()=>{var c;return[(d(!0),g(W,null,ce(i(ve)((c=z(o))==null?void 0:c.uidt),ye=>(d(),g(W,{key:ye.value},[i(se)(o,ye)?(d(),x(m,{key:0,value:ye.value},{default:N(()=>[ke(Q(ye.text),1)]),_:2},1032,["value"])):R("",!0)],64))),128))]}),_:2},1032,["value","onUpdate:value","placeholder","disabled","onChange"]),["blank","notblank"].includes(o.comparison_op)?(d(),g("div",da)):[i(e).Date,i(e).DateTime].includes((Se=z(o))==null?void 0:Se.uidt)?(d(),x(f,{key:3,value:o.comparison_sub_op,"onUpdate:value":c=>o.comparison_sub_op=c,"dropdown-match-select-width":!1,class:me(["caption nc-filter-sub_operation-select min-w-28",{"flex-grow w-full":!_(o),"max-w-28":_(o)}]),placeholder:t.$t("labels.operationSub"),density:"compact",variant:"solo",disabled:o.readOnly,"hide-details":"","dropdown-class-name":"nc-dropdown-filter-comp-sub-op",onChange:c=>U(o,T)},{default:N(()=>[(d(!0),g(W,null,ce(i(Te)(o.comparison_op),c=>(d(),g(W,{key:c.value},[i(le)(o,c)?(d(),x(m,{key:0,value:c.value},{default:N(()=>[ke(Q(c.text),1)]),_:2},1032,["value"])):R("",!0)],64))),128))]),_:2},1032,["value","onUpdate:value","class","placeholder","disabled","onChange"])):R("",!0),o.field&&i(ie)[o.field]==="boolean"?(d(),x(Je,{key:4,checked:o.value,"onUpdate:checked":c=>o.value=c,dense:"",disabled:o.readOnly,onChange:c=>i(l)(o,T)},null,8,["checked","onUpdate:checked","disabled","onChange"])):R("",!0),_(o)?(d(),x(Ke,{key:5,class:"nc-filter-value-select rounded-md min-w-34",column:z(o),filter:o,onUpdateFilterValue:c=>Ve(c,o,T),onClick:r[3]||(r[3]=q(()=>{},["stop"]))},null,8,["column","filter","onUpdateFilterValue"])):[i(e).Date,i(e).DateTime].includes((Oe=z(o))==null?void 0:Oe.uidt)?R("",!0):(d(),g("div",pa)),o.readOnly?R("",!0):(d(),x(h,{key:7,type:"text",size:"small",class:"nc-filter-item-remove-btn self-center",onClick:q(c=>i($)(o,T),["stop"])},{default:N(()=>[(d(),x(pe(i(xe).deleteListItem)))]),_:2},1032,["onClick"]))]))],64)):R("",!0)],64)}),128))],2)):R("",!0),te("div",{ref_key:"addFiltersRowDomRef",ref:ee,class:"flex gap-2"},[de(h,{size:"small",type:"text",class:"!text-brand-500",onClick:r[5]||(r[5]=q(o=>u(),["stop"]))},{default:N(()=>[te("div",ma,[(d(),x(pe(i(xe).plus))),ke(Q(t.$t("activity.addFilter")),1)])]),_:1}),!i(w)&&i(J)<5?(d(),x(h,{key:0,type:"text",size:"small",onClick:r[6]||(r[6]=q(o=>p(),["stop"]))},{default:N(()=>[te("div",va,[(d(),x(pe(i(xe).plus))),ke(" "+Q(t.$t("activity.addFilterGroup")),1)])]),_:1})):R("",!0)],512),i(M).length?R("",!0):(d(),g("div",{key:1,class:me(["flex flex-row text-gray-400 mt-2",{"ml-1":i(O),"ml-0.5":!i(O)}])}," No filters added ",2)),ot(t.$slots,"default",{},void 0,!0)],2)}}});const _a=Gt(fa,[["__scopeId","data-v-4b6e99b4"]]),ga=Object.freeze(Object.defineProperty({__proto__:null,default:_a},Symbol.toStringTag,{value:"Module"}));export{ga as C,_a as _,ta as u};
