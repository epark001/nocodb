import{h as gt,r as m,$ as L,cg as yt,g as wt,cb as xt,S as ht,Z as ae,i as G,ap as Te,l as bt,aq as Ae,fb as kt,cI as It,o as l,c as p,a as d,b5 as oe,E as e,aj as K,cp as ve,C as r,dD as ge,w as s,b as _,aV as W,D as C,F as S,d as R,t as f,W as v,H as M,I as T,f3 as je,cd as Ct,d6 as $e,Q as D,R as V,M as St,N as Rt,p as Dt,e as Vt,fO as Lt}from"./entry.51f4e399.js";import{_ as Et}from"./DeleteModal.vue.909e0964.js";import{M as zt,A as Tt,R as At,e as jt,O as $t,d as Mt,b as Ot,c as Pt,u as Ft,l as Ht,g as Ut,F as Bt}from"./index.5263eb1d.js";import{u as Nt}from"./views.28a76d89.js";import{u as qt}from"./index.9e760c64.js";import{e as ye}from"./dataUtils.edecace3.js";import{i as Gt}from"./fileUtils.43128440.js";import{k as Kt}from"./virtualCell.4dce1393.js";import{u as Wt}from"./useAttachment.c953c895.js";import{a as Jt}from"./useKanbanViewStore.7f9b2a7a.js";import{f as Qt}from"./useMetas.ba7abae7.js";import{D as Me}from"./vuedraggable.umd.f8ba38de.js";import{D as Yt}from"./index.252dc7b4.js";import{C as Zt}from"./index.680937e8.js";import{_ as Xt}from"./Input.c36cd06d.js";import{b as ea,a as ta,_ as aa}from"./index.69bbd6c7.js";import{_ as oa}from"./index.8feceb04.js";import{_ as la}from"./index.2b3cfde3.js";import{_ as na}from"./_plugin-vue_export-helper.c27b6911.js";import"./Icon.vue.1162f18b.js";import"./Button.vue.793bcd1d.js";import"./index.0db47614.js";import"./debounce.7d32c110.js";import"./toNumber.9dc54e53.js";import"./isSymbol.b53bd26f.js";import"./Modal.vue.b59a28af.js";import"./useSharedView.0db5f32b.js";import"./urlUtils.a77f6d4a.js";import"./deepCompare.d32ec333.js";import"./useSmartsheetStore.1784ce8b.js";import"./index.b9981e09.js";import"./Dropdown.dc69c0a4.js";import"./RightOutlined.90e8180f.js";import"./index.c4aafe5c.js";import"./useState.6010d8b6.js";import"./useRefs.154aa2be.js";import"./identity.dd5da9ba.js";import"./_flatRest.ff2d3d5c.js";import"./isMobile.e2e89480.js";import"./useMergedState.5e6500b1.js";import"./index.529d8b39.js";import"./Col.88cfabc0.js";import"./responsiveObserve.501a6cf9.js";import"./index.fbcca285.js";import"./isPlainObject.ecf52d25.js";import"./_getPrototype.ec1165af.js";import"./isNumeric.3f69e2aa.js";import"./LeftOutlined.3bb8aa17.js";const sa=D(()=>V(()=>import("./TruncateText.d8a8df64.js"),["./TruncateText.d8a8df64.js","./TruncateText.vue.bbf76296.js","./entry.51f4e399.js","./entry.0f786d51.css"],import.meta.url).then(n=>n.default||n)),ra=D(()=>V(()=>import("./Image.4fea8a8a.js"),["./Image.4fea8a8a.js","./entry.51f4e399.js","./entry.0f786d51.css"],import.meta.url).then(n=>n.default||n)),ia=D(()=>V(()=>import("./VirtualCell.44092918.js"),["./VirtualCell.44092918.js","./entry.51f4e399.js","./entry.0f786d51.css","./EditOrAddProvider.vue.09b12d8b.js","./Icon.vue.1162f18b.js","./Button.vue.793bcd1d.js","./index.0db47614.js","./debounce.7d32c110.js","./toNumber.9dc54e53.js","./isSymbol.b53bd26f.js","./_plugin-vue_export-helper.c27b6911.js","./Button.95d2a5ed.css","./useBetaFeatureToggle.5dbba600.js","./index.5263eb1d.js","./index.e5ddde08.js","./validation.6db726f3.js","./useMetas.ba7abae7.js","./index.de92142d.js","./FormItem.cda40628.js","./identity.dd5da9ba.js","./_getPrototype.ec1165af.js","./Col.88cfabc0.js","./responsiveObserve.501a6cf9.js","./toArray.06afb623.js","./FormItemContext.e001cd7c.js","./useSize.3b3f469f.js","./_flatRest.ff2d3d5c.js","./isPlainObject.ecf52d25.js","./index.e760d172.js","./Input.7cb175ff.js","./antInputDirective.8ac36ea7.js","./SearchOutlined.dec109ce.js","./TextArea.442a25cb.js","./Password.d493e47a.js","./index.0d6d8ba8.js","./Checkbox.a529f1e6.js","./createForOfIteratorHelper.12419aa5.js","./index.5e746f62.js","./isMobile.e2e89480.js","./useMemo.b13a9257.js","./useMergedState.5e6500b1.js","./useState.6010d8b6.js","./DownOutlined.db6f6406.js","./CheckOutlined.ef30fafc.js","./EditOrAddProvider.44ca9c5b.css","./virtualCell.4dce1393.js","./index.9e760c64.js","./index.252dc7b4.js","./Dropdown.dc69c0a4.js","./RightOutlined.90e8180f.js","./VirtualCell.23f24363.css"],import.meta.url).then(n=>n.default||n)),da=D(()=>V(()=>import("./Cell.aa14ce01.js"),["./Cell.aa14ce01.js","./entry.51f4e399.js","./entry.0f786d51.css","./CellIcon.8a6080fd.js","./index.5263eb1d.js","./cell.1732684e.js","./useMetas.ba7abae7.js","./EditOrAddProvider.vue.09b12d8b.js","./Icon.vue.1162f18b.js","./Button.vue.793bcd1d.js","./index.0db47614.js","./debounce.7d32c110.js","./toNumber.9dc54e53.js","./isSymbol.b53bd26f.js","./_plugin-vue_export-helper.c27b6911.js","./Button.95d2a5ed.css","./useBetaFeatureToggle.5dbba600.js","./index.e5ddde08.js","./validation.6db726f3.js","./index.de92142d.js","./FormItem.cda40628.js","./identity.dd5da9ba.js","./_getPrototype.ec1165af.js","./Col.88cfabc0.js","./responsiveObserve.501a6cf9.js","./toArray.06afb623.js","./FormItemContext.e001cd7c.js","./useSize.3b3f469f.js","./_flatRest.ff2d3d5c.js","./isPlainObject.ecf52d25.js","./index.e760d172.js","./Input.7cb175ff.js","./antInputDirective.8ac36ea7.js","./SearchOutlined.dec109ce.js","./TextArea.442a25cb.js","./Password.d493e47a.js","./index.0d6d8ba8.js","./Checkbox.a529f1e6.js","./createForOfIteratorHelper.12419aa5.js","./index.5e746f62.js","./isMobile.e2e89480.js","./useMemo.b13a9257.js","./useMergedState.5e6500b1.js","./useState.6010d8b6.js","./DownOutlined.db6f6406.js","./CheckOutlined.ef30fafc.js","./EditOrAddProvider.44ca9c5b.css","./index.9e760c64.js","./index.252dc7b4.js","./Dropdown.dc69c0a4.js","./RightOutlined.90e8180f.js","./Cell.c77dfd55.css"],import.meta.url).then(n=>n.default||n)),ua=D(()=>V(()=>import("./VirtualCell.4b63c3ca.js"),["./VirtualCell.4b63c3ca.js","./entry.51f4e399.js","./entry.0f786d51.css","./index.5263eb1d.js","./virtualCell.4dce1393.js"],import.meta.url).then(n=>n.default||n)),ca=D(()=>V(()=>import("./Cell.4f83cd62.js"),["./Cell.4f83cd62.js","./entry.51f4e399.js","./entry.0f786d51.css","./index.5263eb1d.js","./cell.1732684e.js","./useMetas.ba7abae7.js","./useSmartsheetRowStore.aafbb4bb.js","./deepCompare.d32ec333.js","./dataUtils.edecace3.js","./virtualCell.4dce1393.js","./index.b9981e09.js","./_plugin-vue_export-helper.c27b6911.js","./Cell.69966cf7.css"],import.meta.url).then(n=>n.default||n)),ma=D(()=>V(()=>import("./Row.ee5827e6.js"),["./Row.ee5827e6.js","./index.5263eb1d.js","./useSmartsheetRowStore.aafbb4bb.js","./entry.51f4e399.js","./entry.0f786d51.css","./deepCompare.d32ec333.js","./dataUtils.edecace3.js","./virtualCell.4dce1393.js","./index.b9981e09.js","./useMetas.ba7abae7.js","./useSmartsheetStore.1784ce8b.js","./views.28a76d89.js","./useSharedView.0db5f32b.js"],import.meta.url).then(n=>n.default||n)),pa=D(()=>V(()=>import("./Pagination.31c9fe70.js"),["./Pagination.31c9fe70.js","./entry.51f4e399.js","./entry.0f786d51.css","./index.5263eb1d.js","./sidebar.e289f4e1.js","./views.28a76d89.js","./useMetas.ba7abae7.js","./useSharedView.0db5f32b.js","./index.e760d172.js","./Input.7cb175ff.js","./antInputDirective.8ac36ea7.js","./FormItemContext.e001cd7c.js","./SearchOutlined.dec109ce.js","./isPlainObject.ecf52d25.js","./_getPrototype.ec1165af.js","./TextArea.442a25cb.js","./Password.d493e47a.js","./index.09b19c06.js","./LeftOutlined.3bb8aa17.js","./RightOutlined.90e8180f.js","./index.5e746f62.js","./toArray.06afb623.js","./isMobile.e2e89480.js","./useMemo.b13a9257.js","./useMergedState.5e6500b1.js","./useState.6010d8b6.js","./DownOutlined.db6f6406.js","./CheckOutlined.ef30fafc.js","./useBreakpoint.a91853f1.js","./responsiveObserve.501a6cf9.js","./_plugin-vue_export-helper.c27b6911.js","./Pagination.9d252b04.css"],import.meta.url).then(n=>n.default||n)),_a=D(()=>V(()=>import("./index.a350d282.js").then(n=>n.i),["./index.a350d282.js","./entry.51f4e399.js","./entry.0f786d51.css","./TableIcon.vue.27fb2d8a.js","./Button.vue.793bcd1d.js","./index.0db47614.js","./debounce.7d32c110.js","./toNumber.9dc54e53.js","./isSymbol.b53bd26f.js","./_plugin-vue_export-helper.c27b6911.js","./Button.95d2a5ed.css","./Modal.vue.b59a28af.js","./DeleteModal.7ab6f524.css","./useDashboard.fc1e1c09.js","./useViewData.d5cf5dca.js","./useMetas.ba7abae7.js","./virtualCell.4dce1393.js","./dataUtils.edecace3.js","./index.5263eb1d.js","./useSharedView.0db5f32b.js","./useSmartsheetStore.1784ce8b.js","./views.28a76d89.js","./index.b9981e09.js","./index.9e760c64.js","./useCopy.3e897b55.js","./useKanbanViewStore.7f9b2a7a.js","./deepCompare.d32ec333.js","./useSmartsheetRowStore.aafbb4bb.js","./index.252dc7b4.js","./Dropdown.dc69c0a4.js","./RightOutlined.90e8180f.js","./Icon.vue.1162f18b.js","./index.82c42c24.js","./chevron-down.b89ef60a.js","./index.af5eff28.js","./index.883a1693.css"],import.meta.url).then(n=>n.default||n)),we=n=>(Dt("data-v-d7caa97e"),n=n(),Vt(),n),fa={key:0,class:"flex flex-row min-h-full gap-x-2"},va={key:0,class:"mt-2.5 px-3 !w-full"},ga={class:"nc-kanban-stack-head font-medium flex items-center"},ya={key:0,class:"w-full flex w-[15px]"},wa={class:"py-2 flex gap-2 items-center"},xa={class:"py-2 flex gap-1.8 items-center"},ha={class:"py-2 flex gap-2 items-center"},ba=["data-stack-title"],ka={class:"nc-kanban-item py-2 pl-3 pr-2"},Ia=we(()=>d("a",null,[d("div",{class:"pt-[12px]"},[d("div")])],-1)),Ca=we(()=>d("div",{style:{"z-index":"1"}},null,-1)),Sa=we(()=>d("div",{style:{"z-index":"1"}},null,-1)),Ra={key:0},Da={class:"flex flex-row w-full justify-start pt-2"},Va={class:"w-full text-gray-400"},La={class:"!rounded-lg !px-3 pt-3"},Ea={key:0,class:"text-center"},za={class:"nc-kanban-data-count text-gray-500"},Ta=["onClick"],Aa=["onClick"],ja={key:0,class:"mt-4 px-3 !w-full"},$a={key:1,class:"nc-kanban-data-count mt-[12px] mx-[10px]"},Ma={class:"nc-project-menu-item nc-kanban-context-menu-item"},Oa={class:"nc-project-menu-item nc-kanban-context-menu-item"},Pa={key:0,class:"flex flex-row items-center py-2 px-2.25 bg-gray-100 rounded-lg text-gray-700 mb-4"},Fa={class:"capitalize text-ellipsis overflow-hidden select-none w-full pl-1.75",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},Ha=100,Ua=gt({__name:"Kanban",setup(n){const le=m(),E=L(zt,m()),J=L(Tt,m()),ne=L(At),se=L(jt),A=L($t,yt()),w=L(Mt,m(!1)),h=L(Ot,m(!1)),O=m(!1),re=m(),xe=m(),P=m(!1),Q=m(""),he=m(0),ie=wt(),F=ie.currentRoute,{getPossibleAttachmentSrc:Oe}=Wt(),{loadKanbanData:be,loadMoreKanbanData:Pe,loadKanbanMeta:de,kanbanMetaData:Y,formattedData:z,updateOrSaveRow:Fe,updateKanbanMeta:He,addEmptyRow:Ue,groupingFieldColOptions:g,updateKanbanStackMeta:Be,groupingField:ke,countByStack:y,deleteStack:Ne,shouldScrollToRight:Ie,deleteRow:qe,moveHistory:Ce}=Jt(),{isViewDataLoading:Z}=xt(Nt()),{isUIAllowed:Ge}=qt(),{appInfo:Ke}=ht(),{addUndo:We,defineViewScope:Je}=Qt();ae(Pt,m(!1)),ae(Ft,m(!1)),ae(Ht,m(!1)),ae(Ut,m(!0));const b=G(()=>Ge("xcDatatableEditable")),Qe=L(Bt,m([])),Ye=G(()=>Qe.value.filter(t=>{var a;return t.id!==((a=Y.value)==null?void 0:a.fk_cover_image_col_id)})),H=G(()=>{var t,a;return(t=E.value)!=null&&t.columnsById?E.value.columnsById[(a=Y.value)==null?void 0:a.fk_cover_image_col_id]:{}}),ue=m(),X=m(""),Ze=(t,a)=>{const u=t.row[a.title];return u?Array.isArray(u)&&u.length===0:!0};ne==null||ne.on(async()=>{await de(),await be()});const Se=t=>{var a;try{return(a=H.value)!=null&&a.title&&t.row[H.value.title]?typeof t.row[H.value.title]=="string"?JSON.parse(t.row[H.value.title]):t.row[H.value.title]:[]}catch{return[]}},ce=m(!1);se==null||se.on(async()=>{await de(),ce.value=!0,Te(()=>{ce.value=!1})});const me=(t,a)=>{const u=ye(t.row,E.value.columns);u?ie.push({query:{...F.value.query,rowId:u}}):(re.value=t,xe.value=a,O.value=!0)},Re=m(!1),j=G({get:()=>Re.value,set:t=>{b.value&&(Re.value=t)}}),$=m(null),Xe=(t,a)=>{t.preventDefault(),a&&($.value=a)},ee=G({get(){return!!F.value.query.rowId},set(t){t||ie.push({query:{...F.value.query,rowId:void 0}})}}),et=async(t,a)=>{t.target&&me(a)};function tt(t){if(t.draggedContext.futureIndex===0)return!1}async function pe(t,a=!1){if(t.moved){const{oldIndex:u,newIndex:x}=t.moved,{fk_grp_col_id:k,meta:te}=Y.value;g.value[u].order=x,g.value[x].order=u;const U=JSON.parse(te)||{};U[k]=g.value,await He({meta:U}),a||We({undo:{fn:async I=>{const B=g.value.splice(I.moved.newIndex,1);g.value.splice(I.moved.oldIndex,0,B[0]),await pe(I,!0)},args:[{moved:{oldIndex:u,newIndex:x}}]},redo:{fn:async I=>{const B=g.value.splice(I.moved.oldIndex,1);g.value.splice(I.moved.newIndex,0,B[0]),await pe(I,!0)},args:[{moved:{oldIndex:u,newIndex:x}},!0]},scope:Je({view:J.value})})}}async function at(t,a){if(t.added){const u=t.added.element;Ce.value.unshift({op:"added",pk:ye(t.added.element.row,E.value.columns),index:t.added.newIndex,stack:a}),u.row[ke.value]=a,y.value.set(a,y.value.get(a)+1),await Fe(u)}else t.removed&&(y.value.set(a,y.value.get(a)-1),Ce.value.unshift({op:"removed",pk:ye(t.removed.element.row,E.value.columns),index:t.removed.oldIndex,stack:a}))}const De=Lt(async t=>{if(t.target.scrollTop+t.target.clientHeight+Ha>=t.target.scrollHeight){const a=t.target.getAttribute("data-stack-title"),u=Ke.value.defaultLimit||25,x=z.value.get(a);if(x){const k=Math.ceil(x.length/u);await Pe(a,{offset:k*u})}}}),ot=t=>{t&&(t.removeEventListener("scroll",De),t.addEventListener("scroll",De))},lt=(t,a)=>{P.value=!0,Q.value=t,he.value=a},nt=async()=>{await Ne(Q.value,he.value),P.value=!1},Ve=async t=>{g.value[t].collapsed=!g.value[t].collapsed,h.value||await Be()},Le=async()=>{const t=await Ue();t.row={[ke.value]:X.value===""?null:X.value},y.value.set(null,y.value.get(null)+1),me(t)};return A==null||A.on(Le),bt(()=>A.off(Le)),Ae(j,()=>{j.value||($.value=null)}),Ae(J,async t=>{if((t==null?void 0:t.type)===kt.KANBAN){Z.value=!0;try{await de(),Z.value=!1,await be(),Te(()=>{Ie.value&&(ue.value.scrollTo({left:ue.value.scrollWidth,behavior:"smooth"}),Ie.value=!1)})}catch(a){console.error(a),Z.value=!1}}},{immediate:!0}),(t,a)=>{const u=Xt,x=sa,k=St,te=Rt,U=Yt,I=ea,B=ra,st=oa,rt=ia,it=da,dt=ua,ut=ca,_e=Zt,ct=ma,mt=ta,pt=aa,_t=la,ft=pa,Ee=_a,vt=Et,N=It("e");return l(),p(K,null,[d("div",{class:"flex flex-col w-full bg-white","data-testid":"nc-kanban-wrapper",style:oe({minHeight:"calc(100vh - var(--topbar-height))"})},[d("div",{ref_key:"kanbanContainerRef",ref:ue,class:"nc-kanban-container flex mt-4 pb-4 px-4 overflow-y-hidden w-full nc-scrollbar-x-md",style:oe({minHeight:"calc(100vh - var(--topbar-height) - 3.5rem)",maxHeight:"calc(100vh - var(--topbar-height) - 3.5rem)"})},[e(Z)?(l(),p("div",fa,[(l(!0),p(K,null,ve(Array(20),o=>(l(),r(u,{key:o,class:"!min-w-80 !min-h-full !rounded-xl overflow-hidden"}))),128))])):(l(),r(U,{key:1,visible:e(j),"onUpdate:visible":a[9]||(a[9]=o=>M(j)?j.value=o:null),trigger:["contextmenu"],"overlay-class-name":"nc-dropdown-kanban-context-menu"},ge({default:s(()=>[_(e(Me),{modelValue:e(g),"onUpdate:modelValue":a[2]||(a[2]=o=>M(g)?g.value=o:null),class:"flex gap-4","item-key":"id",group:"kanban-stack",draggable:".nc-kanban-stack",filter:".not-draggable",move:tt,onStart:a[3]||(a[3]=o=>o.target.classList.add("grabbing")),onEnd:a[4]||(a[4]=o=>o.target.classList.remove("grabbing")),onChange:a[5]||(a[5]=o=>pe(o))},{item:s(({element:o,index:fe})=>[d("div",{class:T(["nc-kanban-stack",{"w-[50px]":o.collapsed}])},[o.collapsed?(l(),r(_e,{key:`${o.id}-collapsed`,style:oe(`background-color: ${o.color} !important`),class:T(["nc-kanban-collapsed-stack mx-4 flex items-center w-[300px] h-[50px] !rounded-xl cursor-pointer h-full !pr-[10px] overflow-hidden",{"not-draggable":o.title===null||e(w)||e(h)||!e(b)}]),"body-style":{padding:"0px",height:"100%",width:"100%",background:"#f0f2f5 !important"}},{default:s(()=>[d("div",{class:"items-center justify-between",onClick:c=>Ve(fe)},[!e(z).get(o.title)||!e(y)?(l(),p("div",ja,[_(u,{active:!0,class:"!w-full !h-4 !rounded-lg overflow-hidden"})])):(l(),p("div",$a,[d("div",{class:T(["float-right flex gap-2 items-center cursor-pointer font-bold",{capitalize:o.title===null}])},[_(x,null,{default:s(()=>[R(f(o.title??"uncategorized"),1)]),_:2},1024),(l(),r(C(e(S).arrowDown),{class:"text-grey text-lg"}))],2),R(f(e(z).get(o.title).length)+" / "+f(e(y).get(o.title))+" "+f(e(y).get(o.title)!==1?t.$t("objects.records"):t.$t("objects.record")),1)]))],8,Aa)]),_:2},1032,["style","class"])):(l(),r(_e,{key:o.id,class:T(["mx-4 !bg-gray-100 flex flex-col w-80 h-full !rounded-xl overflow-y-hidden",{"not-draggable":o.title===null||e(w)||e(h)||!e(b),"!cursor-default":e(w)||!e(b)}]),"head-style":{paddingBottom:"0px"},"body-style":{padding:"0px",height:"100%",borderRadius:"0.75rem !important",paddingBottom:"0rem"}},{default:s(()=>[d("div",{style:oe(`background-color: ${o.color}`),class:"nc-kanban-stack-head-color h-[10px] mt-3 mx-3 rounded-full"},null,4),!e(z).get(o.title)||!e(y)?(l(),p("div",va,[_(u,{active:!0,class:"!w-full !h-9.75 !rounded-lg overflow-hidden"})])):(l(),r(pt,{key:1,class:"!bg-gray-100"},{default:s(()=>[_(I,null,{default:s(()=>[d("div",ga,[_(U,{trigger:["click"],"overlay-class-name":"nc-dropdown-kanban-stack-context-menu",class:"bg-white !rounded-lg"},ge({default:s(()=>[d("div",{class:T(["flex items-center w-full mx-2 px-3 py-1",{capitalize:o.title===null,"cursor-pointer":!e(w)}])},[_(x,null,{default:s(()=>[R(f(o.title??"uncategorized"),1)]),_:2},1024),e(w)?v("",!0):(l(),p("span",ya,[(l(),r(C(e(S).arrowDown),{class:"text-grey text-lg ml-auto"}))]))],2)]),_:2},[e(w)?void 0:{name:"overlay",fn:s(()=>[_(te,{class:"ml-6 !text-sm !px-0 !py-2 !rounded"},{default:s(()=>[e(b)&&!e(h)&&!e(w)?W((l(),r(k,{key:0,onClick:()=>{X.value=o.title,e(A).trigger(o.title)}},{default:s(()=>[d("div",wa,[(l(),r(C(e(S).plus),{class:"text-gray-500"})),R(" "+f(t.$t("activity.addNewRecord")),1)])]),_:2},1032,["onClick"])),[[N,["c:kanban:add-new-record"]]]):v("",!0),W((l(),r(k,{onClick:c=>Ve(fe)},{default:s(()=>[d("div",xa,[(l(),r(C(e(S).arrowCollapse),{class:"text-gray-500"})),R(" "+f(t.$t("activity.kanban.collapseStack")),1)])]),_:2},1032,["onClick"])),[[N,["c:kanban:collapse-stack"]]]),o.title!==null&&!e(h)&&e(b)?W((l(),r(k,{key:1,onClick:c=>lt(o.title,fe)},{default:s(()=>[d("div",ha,[(l(),r(C(e(S).delete),{class:"text-gray-500"})),R(" "+f(t.$t("activity.kanban.deleteStack")),1)])]),_:2},1032,["onClick"])),[[N,["c:kanban:delete-stack"]]]):v("",!0)]),_:2},1024)]),key:"0"}]),1024)])]),_:2},1024),_(mt,{class:"overflow-y-hidden mt-1",style:{"max-height":"calc(100% - 11rem)"}},{default:s(()=>[d("div",{ref:ot,class:"nc-kanban-list h-full nc-scrollbar-dark-md","data-stack-title":o.title},[_(e(Me),{list:e(z).get(o.title),"item-key":"row.Id",draggable:".nc-kanban-item",group:"kanban-card",class:"h-full",filter:".not-draggable",onStart:a[0]||(a[0]=c=>c.target.classList.add("grabbing")),onEnd:a[1]||(a[1]=c=>c.target.classList.remove("grabbing")),onChange:c=>at(c,o.title)},{item:s(({element:c})=>[d("div",ka,[_(ct,{row:c},{default:s(()=>{var ze;return[_(_e,{hoverable:"","data-stack":o.title,class:T(["!rounded-xl h-full overflow-hidden break-all max-w-[450px]",{"not-draggable":e(w)||!e(b)||e(h),"!cursor-default":e(w)||!e(b)||e(h)}]),"body-style":{padding:"10px"},onClick:i=>et(i,c),onContextmenu:i=>Xe(i,c)},ge({default:s(()=>[(l(!0),p(K,null,ve(e(Ye),i=>(l(),p("div",{key:`record-${c.row.id}-${i.id}`,class:"flex flex-col rounded-lg w-full"},[!Ze(c,i)||e(Kt)(i.uidt,i.colOptions)?(l(),p("div",Ra,[d("div",Da,[d("div",Va,[e(je)(i)?(l(),r(rt,{key:0,column:i,"hide-menu":!0},null,8,["column"])):(l(),r(it,{key:1,column:i,"hide-menu":!0},null,8,["column"]))])]),d("div",{class:T(["flex flex-row w-full items-center justify-start",{"!ml-[-12px] pl-3":i.uidt===e(Ct).SingleSelect}])},[i.title&&e(je)(i)?(l(),r(dt,{key:0,modelValue:c.row[i.title],"onUpdate:modelValue":q=>c.row[i.title]=q,class:"text-sm pt-1 pl-5",column:i,row:c},null,8,["modelValue","onUpdate:modelValue","column","row"])):i.title?(l(),r(ut,{key:1,modelValue:c.row[i.title],"onUpdate:modelValue":q=>c.row[i.title]=q,class:"text-sm pt-1 pl-7.25",column:i,"edit-enabled":!1,"read-only":!0},null,8,["modelValue","onUpdate:modelValue","column"])):v("",!0)],2)])):v("",!0)]))),128))]),_:2},[(ze=e(Y))!=null&&ze.fk_cover_image_col_id?{name:"cover",fn:s(()=>[!e(ce)&&Se(c).length?(l(),r(st,{key:0,autoplay:"",class:"gallery-carousel",arrows:""},{customPaging:s(()=>[Ia]),prevArrow:s(()=>[Ca]),nextArrow:s(()=>[Sa]),default:s(()=>[(l(!0),p(K,null,ve(Se(c),(i,q)=>(l(),p(K,null,[e(Gt)(i.title,i.mimetype??i.type)?(l(),r(B,{key:`carousel-${c.row.id}-${q}`,class:"h-52 object-cover",srcs:e(Oe)(i)},null,8,["srcs"])):v("",!0)],64))),256))]),_:2},1024)):(l(),r(C(e(S).imagePlaceholder),{key:1,class:"w-full h-48 my-4 text-cool-gray-200"}))]),key:"0"}:void 0]),1032,["data-stack","class","onClick","onContextmenu"])]}),_:2},1032,["row"])])]),_:2},1032,["list","onChange"])],8,ba)]),_:2},1024),d("div",La,[e(z).get(o.title)?(l(),p("div",Ea,[d("div",za,f(e(z).get(o.title).length)+" / "+f(e(y).get(o.title)??0)+" "+f(e(y).get(o.title)!==1?t.$t("objects.records"):t.$t("objects.record")),1),d("div",{class:"flex flex-row w-full mt-3 justify-between items-center cursor-pointer bg-white px-4 py-2 rounded-lg border-gray-100 border-1 shadow-sm shadow-gray-100",onClick:()=>{X.value=o.title,e(A).trigger(o.title)}},[R(" Add Record "),!e(h)&&!e(w)?(l(),r(C(e(S).plus),{key:0,class:""})):v("",!0)],8,Ta)])):v("",!0)])]),_:2},1024))]),_:2},1032,["class"]))],2)]),_:1},8,["modelValue"])]),_:2},[!e(w)&&!e(h)&&e(b)?{name:"overlay",fn:s(()=>[_(te,{class:"shadow !rounded !py-0",onClick:a[8]||(a[8]=o=>j.value=!1)},{default:s(()=>[e($)?(l(),r(k,{key:0,onClick:a[6]||(a[6]=o=>me(e($)))},{default:s(()=>[W((l(),p("div",Ma,[(l(),r(C(e(S).expand),{class:"flex"})),R(f(t.$t("activity.expandRecord")),1)])),[[N,["a:kanban:expand-record"]]])]),_:1})):v("",!0),_(_t,{class:"!m-0 !p-0"}),e($)?(l(),r(k,{key:1,onClick:a[7]||(a[7]=o=>e(qe)(e($)))},{default:s(()=>[W((l(),p("div",Oa,[(l(),r(C(e(S).delete),{class:"flex"})),R(f(t.$t("activity.deleteRecord")),1)])),[[N,["a:kanban:delete-record"]]])]),_:1})):v("",!0)]),_:1})]),key:"0"}:void 0]),1032,["visible"]))],4),_(ft,{"pagination-data":e(le),"onUpdate:paginationData":a[10]||(a[10]=o=>M(le)?le.value=o:null),"align-count-on-right":"","hide-pagination":"",class:"!py-4"},null,8,["pagination-data"])],4),(l(),r($e,null,{default:s(()=>[e(re)&&e(O)?(l(),r(Ee,{key:0,modelValue:e(O),"onUpdate:modelValue":a[11]||(a[11]=o=>M(O)?O.value=o:null),row:e(re),state:e(xe),meta:e(E),view:e(J)},null,8,["modelValue","row","state","meta","view"])):v("",!0)]),_:1})),(l(),r($e,null,{default:s(()=>[e(ee)?(l(),r(Ee,{key:e(F).query.rowId,modelValue:e(ee),"onUpdate:modelValue":a[12]||(a[12]=o=>M(ee)?ee.value=o:null),row:{row:{},oldRow:{},rowMeta:{}},meta:e(E),"row-id":e(F).query.rowId,view:e(J)},null,8,["modelValue","meta","row-id","view"])):v("",!0)]),_:1})),_(vt,{visible:e(P),"onUpdate:visible":a[13]||(a[13]=o=>M(P)?P.value=o:null),"entity-name":"Stack","on-delete":nt},{"entity-preview":s(()=>[e(Q)?(l(),p("div",Pa,[d("div",Fa,f(e(Q)),1)])):v("",!0)]),_:1},8,["visible"])],64)}}});const Oo=na(Ua,[["__scopeId","data-v-d7caa97e"]]);export{Oo as default};
