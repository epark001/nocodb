import{h as p,i as y,r as d,k as g,R as O,eX as h,aq as c,o as j,c as V}from"./entry.13466615.js";import{d as m}from"./deepCompare.d32ec333.js";function k(){return new Worker(""+new URL("json.worker-82831a95.js",import.meta.url).href,{type:"module"})}function v(){return new Worker(""+new URL("editor.worker-22323291.js",import.meta.url).href,{type:"module"})}function b(){return new Worker(""+new URL("ts.worker-65e1d00f.js",import.meta.url).href,{type:"module"})}const D=p({__name:"Editor",props:{modelValue:{},hideMinimap:{type:Boolean},lang:{default:"json"},validate:{type:Boolean,default:!0},disableDeepCompare:{type:Boolean,default:!1},readOnly:{type:Boolean}},emits:["update:modelValue"],setup(a,{expose:f,emit:s}){const o=y({get:()=>typeof a.modelValue=="object"?JSON.stringify(a.modelValue,null,2):a.modelValue,set:t=>{if(typeof a.modelValue=="object")try{s("update:modelValue",typeof t=="object"?t:JSON.parse(t))}catch(r){console.error(r)}else s("update:modelValue",t)}}),n=d(!0);self.MonacoEnvironment={getWorker(t,r){switch(r){case"json":return new k;case"typescript":return new b;default:return new v}}};const i=d();let e;return f({format:()=>{e.setValue(JSON.stringify(JSON.parse(e==null?void 0:e.getValue()),null,2))},isValid:n}),g(async()=>{const{editor:t,languages:r}=await O(()=>import("./editor.main.b05df9f3.js").then(u=>u.e),["./editor.main.b05df9f3.js","./entry.13466615.js","./entry.0f786d51.css","./editor.f9349c7d.css"],import.meta.url);if(i.value&&a.lang){const u=t.createModel(o.value,a.lang);a.lang==="json"&&r.json.jsonDefaults.setDiagnosticsOptions({validate:a.validate}),e=t.create(i.value,{model:u,theme:"vs",foldingStrategy:"indentation",selectOnLineNumbers:!0,scrollbar:{verticalScrollbarSize:8,horizontalScrollbarSize:8},tabSize:2,automaticLayout:!0,readOnly:a.readOnly,minimap:{enabled:!a.hideMinimap}}),e.onDidChangeModelContent(async()=>{try{if(n.value=!0,a.disableDeepCompare||a.lang!=="json")o.value=e.getValue();else{const l=JSON.parse(e.getValue());(!l||!m(o.value,l))&&(o.value=l)}}catch(l){n.value=!1,console.log(l)}}),h()||e.focus()}}),c(o,t=>{if(!e||!t)return;const r=e==null?void 0:e.getValue();!a.disableDeepCompare&&a.lang==="json"?(!r||!m(JSON.parse(t),JSON.parse(r)))&&e.setValue(t):r!==t&&e.setValue(t)}),c(()=>a.readOnly,t=>{e&&e.updateOptions({readOnly:t})}),(t,r)=>(j(),V("div",{ref_key:"root",ref:i},null,512))}});export{D as _};
