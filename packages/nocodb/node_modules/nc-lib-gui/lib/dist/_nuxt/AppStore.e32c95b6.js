import{h as U,A as T,r as v,k as F,o as l,c as y,b as u,w as i,E as o,C as p,W as I,cA as J,H as $,a,t as f,d as _,aj as O,cp as H,D as A,F as P,b5 as K,I as Q,Q as W,R as q,J as h,K as z,P as G,L as X,p as Y,e as Z,f as ee}from"./entry.51f4e399.js";import{_ as te}from"./round-edit.79f3d5bf.js";import{C as se}from"./index.680937e8.js";import{_ as ae}from"./Title.e76f8bdd.js";import{_ as le}from"./_plugin-vue_export-helper.c27b6911.js";import"./index.c4aafe5c.js";import"./Dropdown.dc69c0a4.js";import"./useState.6010d8b6.js";import"./useRefs.154aa2be.js";import"./identity.dd5da9ba.js";import"./isSymbol.b53bd26f.js";import"./_flatRest.ff2d3d5c.js";import"./isMobile.e2e89480.js";import"./useMergedState.5e6500b1.js";import"./index.529d8b39.js";import"./Col.88cfabc0.js";import"./responsiveObserve.501a6cf9.js";import"./index.fbcca285.js";import"./isPlainObject.ecf52d25.js";import"./_getPrototype.ec1165af.js";import"./TextArea.442a25cb.js";import"./Input.7cb175ff.js";import"./antInputDirective.8ac36ea7.js";import"./FormItemContext.e001cd7c.js";import"./CheckOutlined.ef30fafc.js";const oe=W(()=>q(()=>import("./AppInstall.0ce0d3b3.js"),["./AppInstall.0ce0d3b3.js","./Button.vue.793bcd1d.js","./entry.51f4e399.js","./entry.0f786d51.css","./index.0db47614.js","./debounce.7d32c110.js","./toNumber.9dc54e53.js","./isSymbol.b53bd26f.js","./_plugin-vue_export-helper.c27b6911.js","./Button.95d2a5ed.css","./index.e760d172.js","./Input.7cb175ff.js","./antInputDirective.8ac36ea7.js","./FormItemContext.e001cd7c.js","./SearchOutlined.dec109ce.js","./isPlainObject.ecf52d25.js","./_getPrototype.ec1165af.js","./TextArea.442a25cb.js","./Password.d493e47a.js","./index.de92142d.js","./FormItem.cda40628.js","./identity.dd5da9ba.js","./Col.88cfabc0.js","./responsiveObserve.501a6cf9.js","./toArray.06afb623.js","./useSize.3b3f469f.js","./_flatRest.ff2d3d5c.js","./index.e56af360.js"],import.meta.url).then(c=>c.default||c)),ne=c=>(Y("data-v-ba895a0a"),c=c(),Z(),c),ie={class:"flex flex-col h-full"},re={class:"flex flex-row justify-center mt-2 text-center w-full text-base"},ce={class:"flex mt-6 justify-center space-x-2"},pe={class:"grid grid-cols-2 gap-x-2 gap-y-4 mt-4"},de={class:"install-btn flex flex-row justify-end space-x-1"},ue={class:"flex flex-row justify-center items-center caption capitalize nc-app-store-card-edit"},_e={class:"flex flex-row justify-center items-center caption capitalize nc-app-store-card-reset"},me=ne(()=>a("div",{class:"flex ml-0.5"},"Reset",-1)),fe={class:"flex flex-row justify-center items-center caption capitalize nc-app-store-card-install"},ve={class:"flex flex-row space-x-2 items-center justify-start w-full"},ye={class:"flex w-20 pl-3"},ge=["src"],xe={key:1},we={class:"flex flex-col flex-1 w-3/5 pl-3"},he=U({__name:"AppStore",setup(c){const{t:M}=T(),{$api:k,$e:g}=ee(),x=v(null),d=v(!1),r=v(!1),n=v(null),w=async()=>{try{const s=(await k.plugin.list()).list??[];x.value=s.map(t=>({...t,tags:t.tags?t.tags.split(","):[],parsedInput:t.input&&JSON.parse(t.input)}))}catch(s){h.error(await z(s))}},j=async()=>{try{await k.plugin.update(n.value.id,{input:null,active:!1}),h.success(M("msg.success.pluginUninstalled")),d.value=!1,await w()}catch(s){h.error(await z(s))}g("a:appstore:reset",{app:n.value.title})},E=async()=>{r.value=!1,await w(),g("a:appstore:install",{app:n.value.title})},C=async s=>{r.value=!0,n.value=s,g("c:appstore:install",{app:s.title})},R=async s=>{d.value=!0,n.value=s};return F(async()=>{x.value===null&&await w()}),(s,t)=>{const N=oe,b=G,m=X,B=te,D=ae,V=se;return l(),y("div",null,[u(b,J({visible:o(r),"onUpdate:visible":t[2]||(t[2]=e=>$(r)?r.value=e:null),class:{active:o(r)},closable:!1,centered:"","min-height":"300",footer:null,"wrap-class-name":"nc-modal-plugin-install"},s.$attrs),{default:i(()=>[o(n)&&o(r)?(l(),p(N,{key:0,id:o(n).id,onClose:t[0]||(t[0]=e=>r.value=!1),onSaved:t[1]||(t[1]=e=>E())},null,8,["id"])):I("",!0)]),_:1},16,["visible","class"]),u(b,{visible:o(d),"onUpdate:visible":t[4]||(t[4]=e=>$(d)?d.value=e:null),closable:!1,width:"24rem",centered:"",footer:null,"wrap-class-name":"nc-modal-plugin-uninstall"},{default:i(()=>[a("div",ie,[a("div",re,f(`Click on confirm to reset ${o(n)&&o(n).title}`),1),a("div",ce,[u(m,{onClick:t[3]||(t[3]=e=>d.value=!1)},{default:i(()=>[_(f(s.$t("general.cancel")),1)]),_:1}),u(m,{type:"primary",danger:"",onClick:j},{default:i(()=>[_(f(s.$t("general.confirm")),1)]),_:1})])])]),_:1},8,["visible"]),a("div",pe,[(l(!0),y(O,null,H(o(x),(e,L)=>(l(),p(V,{key:L,class:Q(`relative flex overflow-x-hidden app-item-card !shadow-sm rounded-md w-full nc-app-store-card-${e.title}`),"body-style":{width:"100%"}},{default:i(()=>[a("div",de,[e.parsedInput?(l(),p(m,{key:0,size:"small",type:"primary",onClick:S=>C(e)},{default:i(()=>[a("div",ue,[u(B,{class:"pr-0.5",height:12}),_(" Edit ")])]),_:2},1032,["onClick"])):I("",!0),e.parsedInput?(l(),p(m,{key:1,size:"small",outlined:"",onClick:S=>R(e)},{default:i(()=>[a("div",_e,[(l(),p(A(o(P).closeCircle))),me])]),_:2},1032,["onClick"])):(l(),p(m,{key:2,size:"small",type:"primary",onClick:S=>C(e)},{default:i(()=>[a("div",fe,[(l(),p(A(o(P).plus))),_(" Install ")])]),_:2},1032,["onClick"]))]),a("div",ve,[a("div",ye,[e.title!=="SMTP"?(l(),y("img",{key:0,class:"avatar",alt:"logo",style:K({backgroundColor:e.title==="SES"?"#242f3e":""}),src:e.logo},null,12,ge)):(l(),y("div",xe))]),a("div",we,[u(D,{level:5},{default:i(()=>[_(f(e.title),1)]),_:2},1024),_(" "+f(e.description),1)])])]),_:2},1032,["class"]))),128))])])}}});const Qe=le(he,[["__scopeId","data-v-ba895a0a"]]);export{Qe as default};
