import{_ as R}from"./View.f9440638.js";import{h as N,r as f,cb as T,i as w,k as U,o as g,c as y,a as p,b as v,E as i,H as $,W as V,J as a,K as s,f as A}from"./entry.13466615.js";import{u as D}from"./useDashboard.34dd8f64.js";import{a as G}from"./useMetas.223da623.js";import{_ as L}from"./index.7677ce8f.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./useSmartsheetStore.9bdf3b91.js";import"./views.3cd4bcb9.js";import"./useSharedView.746b4f21.js";import"./index.5263eb1d.js";import"./index.2a3da6a9.js";import"./Password.d7b16461.js";import"./Input.16966097.js";import"./antInputDirective.8ac36ea7.js";import"./FormItemContext.27b2e5db.js";import"./ProjectIcon.05001560.js";import"./Button.vue.a83cab3b.js";import"./index.f2e6837c.js";import"./debounce.dbc9bf77.js";import"./toNumber.7aa6a805.js";import"./isSymbol.b9109ae5.js";import"./useCopy.a0671815.js";import"./v3-infinite-loading.e93e94ab.js";import"./index.d22afba1.js";import"./QuickImport.vue.13f30a49.js";import"./validation.5ed31fc1.js";import"./index.6f605a00.js";import"./FormItem.fe59dafe.js";import"./identity.b813b76e.js";import"./_getPrototype.00be30f0.js";import"./Col.23d910dc.js";import"./responsiveObserve.9209e727.js";import"./toArray.f6fa5a71.js";import"./useSize.dec45296.js";import"./_flatRest.037bf8e3.js";import"./isPlainObject.4c0f42f1.js";import"./CheckOutlined.80115d65.js";import"./useRefs.6ea70d5c.js";import"./useMergedState.1cc2a884.js";import"./index.62e3d60f.js";import"./Dropdown.a78be736.js";import"./useState.a6853ebd.js";import"./isMobile.e2e89480.js";import"./index.a8ef1b7e.js";import"./SearchOutlined.c1eed30a.js";import"./TextArea.1bd4034f.js";import"./index.1669d181.js";import"./index.7bdf0a46.js";import"./DownOutlined.9cfe3e0c.js";import"./index.2660048d.js";import"./Checkbox.65681aa3.js";import"./createForOfIteratorHelper.37be2624.js";import"./OpenLeftSidebarBtn.vue.55bf93c3.js";import"./Icon.vue.e15b8911.js";import"./Tooltip.vue.30df4de9.js";import"./sidebar.42429978.js";import"./plus.5f5a668e.js";import"./Modal.vue.7eba58e8.js";import"./tab.586445bb.js";import"./index.638acbb4.js";import"./index.3cc83813.js";import"./index.89133b21.js";import"./Modal.vue.fe6a4790.js";import"./index.18c65772.js";import"./index.e7cf7635.js";import"./domUtils.b0dc23e8.js";import"./Select.vue.140b59a5.js";import"./index.4385a501.js";import"./useMemo.4991ab9d.js";import"./chevron-down.166de573.js";import"./send-outline.95d535cb.js";import"./index.2c1df8bc.js";import"./index.2ae12d3e.js";import"./DeleteModal.vue.55101b0a.js";import"./vuedraggable.umd.8d33c631.js";import"./Editor.vue.2426816e.js";import"./deepCompare.d32ec333.js";import"./fileUtils.43128440.js";import"./index.8edf0358.js";import"./RightOutlined.2c092523.js";import"./TableIcon.vue.95089890.js";import"./index.66af8095.js";import"./eagerComputed.9d79768b.js";import"./index.bc4f5185.js";import"./LeftOutlined.b2689280.js";import"./useBreakpoint.66a79637.js";import"./index.9d81d9da.js";import"./index.82f05b6c.js";import"./index.1041b981.js";import"./TruncateText.vue.454bbb27.js";import"./ViewIcon.vue.8aa1efd9.js";import"./View.vue.d0d00de4.js";import"./Overlay.f7b74b5f.js";import"./index.395ba25b.js";import"./index.ff7d18e2.js";const M={class:"flex flex-col py-2 px-3 gap-2 w-full","data-testid":"nc-share-base-sub-modal"},P={class:"flex flex-col w-full p-3 border-1 border-gray-100 rounded-md"},H={class:"flex flex-row w-full justify-between"},J=p("div",{class:"text-black font-medium"},"Enable Public Access",-1),K={key:0,class:"flex flex-col w-full mt-3 border-t-1 pt-3 border-gray-100"},W={class:"flex flex-row justify-between mt-3 bg-gray-50 px-3 py-2 rounded-md"},q=p("div",{class:"text-black"},"Editing access",-1),Ao=N({__name:"ShareBase",setup(z){const{dashboardUrl:x}=D(),{$api:c,$e:_}=A(),o=f(null),{project:r}=T(G()),n=w(()=>o.value&&o.value.uuid?`${x.value}#/base/${o.value.uuid}`:""),k=async()=>{try{if(!r.value.id)return;const t=await c.project.sharedBaseGet(r.value.id);o.value={uuid:t.uuid,url:t.url,role:t.roles}}catch(t){a.error(await s(t))}},u=async(t="viewer")=>{try{if(!r.value.id)return;const e=await c.project.sharedBaseUpdate(r.value.id,{roles:t});o.value=e??{},o.value.role=t}catch(e){a.error(await s(e))}_("a:shared-base:enable",{role:t})},B=async()=>{try{if(!r.value.id)return;await c.project.sharedBaseDisable(r.value.id),o.value=null}catch(t){a.error(await s(t))}_("a:shared-base:disable")};U(()=>{o.value||k()});const d=w(()=>{var t;return!!((t=o.value)!=null&&t.uuid)}),l=f(!1),m=f(!1),j=async()=>{if(!l.value){l.value=!0;try{d.value?await B():await u()}catch(t){a.error(await s(t))}finally{l.value=!1}}},E=async()=>{if(o.value&&!m.value){m.value=!0;try{o.value.role==="viewer"?await u("editor"):await u("viewer")}catch(t){a.error(await s(t))}finally{m.value=!1}}};return(t,e)=>{var b;const h=L,S=R;return g(),y("div",M,[p("div",P,[p("div",H,[J,v(h,{checked:i(d),loading:i(l),class:"ml-2",onClick:j},null,8,["checked","loading"])]),i(d)?(g(),y("div",K,[v(S,{url:i(n),"onUpdate:url":e[0]||(e[0]=C=>$(n)?n.value=C:null)},null,8,["url"]),p("div",W,[q,v(h,{loading:i(m),checked:((b=i(o))==null?void 0:b.role)==="editor",class:"ml-2",onClick:E},null,8,["loading","checked"])])])):V("",!0)])])}}});export{Ao as default};
