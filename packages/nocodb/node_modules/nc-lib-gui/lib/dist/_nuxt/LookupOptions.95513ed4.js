import B from"./VirtualCellIcon.f17eeb0a.js";import{_ as D}from"./CellIcon.8a6080fd.js";import{M as $}from"./index.5263eb1d.js";import{h as A,T as E,$ as N,r as U,cb as P,i as C,eW as F,dg as W,cd as z,k as G,o as n,c as f,a as i,b as m,w as r,E as s,aj as y,cp as O,C as v,t as p,d as S,cA as T,D as H,m as J,f3 as K,p as Q,e as X}from"./entry.51f4e399.js";import{a as Y}from"./EditOrAddProvider.vue.09b12d8b.js";import{a as Z,u as oo}from"./useMetas.ba7abae7.js";import{S as eo,_ as to}from"./index.5e746f62.js";import{_ as lo}from"./FormItem.cda40628.js";import{_ as ao}from"./_plugin-vue_export-helper.c27b6911.js";import"./virtualCell.4dce1393.js";import"./cell.1732684e.js";import"./Icon.vue.1162f18b.js";import"./Button.vue.793bcd1d.js";import"./index.0db47614.js";import"./debounce.7d32c110.js";import"./toNumber.9dc54e53.js";import"./isSymbol.b53bd26f.js";import"./useBetaFeatureToggle.5dbba600.js";import"./index.e5ddde08.js";import"./validation.6db726f3.js";import"./index.de92142d.js";import"./useSize.3b3f469f.js";import"./identity.dd5da9ba.js";import"./_flatRest.ff2d3d5c.js";import"./isPlainObject.ecf52d25.js";import"./_getPrototype.ec1165af.js";import"./FormItemContext.e001cd7c.js";import"./index.e760d172.js";import"./Input.7cb175ff.js";import"./antInputDirective.8ac36ea7.js";import"./SearchOutlined.dec109ce.js";import"./TextArea.442a25cb.js";import"./Password.d493e47a.js";import"./index.0d6d8ba8.js";import"./Checkbox.a529f1e6.js";import"./createForOfIteratorHelper.12419aa5.js";import"./toArray.06afb623.js";import"./isMobile.e2e89480.js";import"./useMemo.b13a9257.js";import"./useMergedState.5e6500b1.js";import"./useState.6010d8b6.js";import"./DownOutlined.db6f6406.js";import"./CheckOutlined.ef30fafc.js";import"./Col.88cfabc0.js";import"./responsiveObserve.501a6cf9.js";const so=_=>(Q("data-v-45fea450"),_=_(),X(),_),io={class:"p-6 w-full flex flex-col border-2 mb-2 mt-4"},no={class:"w-full flex flex-row space-x-2"},ro={class:"flex flex-row h-full pb-0.5 items-center max-w-full"},_o={class:"font-semibold text-xs flex-shrink flex-grow-0 truncate"},uo=so(()=>i("div",{class:"flex-grow"},null,-1)),mo={class:"text-[0.65rem] text-gray-600 nc-relation-details"},po={class:"uppercase"},co={class:"flex items-center -ml-1 font-semibold text-xs"},fo=A({__name:"LookupOptions",props:{value:{}},emits:["update:value"],setup(_,{emit:I}){const t=E(_,"value",I),u=N($,U()),{setAdditionalValidations:L,validateInfos:k,onDataTypeChange:x,isEdit:M}=Y(),V=Z(),{tables:c}=P(V),{metas:j}=oo();L({fk_relation_column_id:[{required:!0,message:"Required"}],fk_lookup_column_id:[{required:!0,message:"Required"}]}),t.value.fk_relation_column_id||(t.value.fk_relation_column_id=null),t.value.fk_lookup_column_id||(t.value.fk_lookup_column_id=null);const h=C(()=>!c.value||!c.value.length||!u.value||!u.value.columns?[]:u.value.columns.filter(o=>{var a;return F(o)&&!o.system&&o.base_id===((a=u.value)==null?void 0:a.base_id)}).map(o=>({col:o.colOptions,column:o,...c.value.find(a=>a.id===o.colOptions.fk_related_model_id)})).filter(o=>{var a;return((a=o.col)==null?void 0:a.fk_related_model_id)===o.id&&!o.mm})),g=C(()=>{const e=h.value.find(o=>o.column.id===t.value.fk_relation_column_id);return e!=null&&e.id?j.value[e.id].columns.filter(o=>!W(o)&&o.id!==t.value.id&&o.uidt!==z.Links):[]});G(()=>{var e,o;M.value&&(t.value.fk_lookup_column_id=(e=t.value.colOptions)==null?void 0:e.fk_lookup_column_id,t.value.fk_relation_column_id=(o=t.value.colOptions)==null?void 0:o.fk_relation_column_id)});const R=()=>{var e,o;t.value.fk_lookup_column_id=(o=(e=g.value)==null?void 0:e[0])==null?void 0:o.id,x()},q=e=>J(K(e)?B:D,{columnMeta:e});return(e,o)=>{const a=eo,w=to,b=lo;return n(),f("div",io,[i("div",no,[m(b,T({class:"flex w-1/2 pb-2",label:e.$t("labels.links")},s(k).fk_relation_column_id),{default:r(()=>[m(w,{value:s(t).fk_relation_column_id,"onUpdate:value":o[0]||(o[0]=l=>s(t).fk_relation_column_id=l),"dropdown-class-name":"!w-64 nc-dropdown-relation-table",onChange:R},{default:r(()=>[(n(!0),f(y,null,O(s(h),(l,d)=>(n(),v(a,{key:d,value:l.col.fk_column_id},{default:r(()=>[i("div",ro,[i("div",_o,p(l.column.title),1),uo,i("div",mo,[i("span",po,p(l.col.type),1),S(" "+p(l.title||l.table_name),1)])])]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},16,["label"]),m(b,T({class:"flex w-1/2",label:e.$t("labels.childColumn")},s(k).fk_lookup_column_id),{default:r(()=>[m(w,{value:s(t).fk_lookup_column_id,"onUpdate:value":o[1]||(o[1]=l=>s(t).fk_lookup_column_id=l),name:"fk_lookup_column_id","dropdown-class-name":"nc-dropdown-relation-column",onChange:s(x)},{default:r(()=>[(n(!0),f(y,null,O(s(g),(l,d)=>(n(),v(a,{key:d,value:l.id},{default:r(()=>[i("div",co,[(n(),v(H(q(l)),{"column-meta":l},null,8,["column-meta"])),S(" "+p(l.title),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["value","onChange"])]),_:1},16,["label"])])])}}});const re=ao(fo,[["__scopeId","data-v-45fea450"]]);export{re as default};
