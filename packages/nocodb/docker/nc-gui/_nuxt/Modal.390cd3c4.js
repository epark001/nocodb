import{h as pe,$ as de,r as b,gx as _e,e$ as ue,B as fe,b4 as he,o as n,C as i,w as a,a as l,E as e,c as f,b as s,d as h,W as m,t as S,H as j,I as w,aj as ve,cp as ge,D as C,F as B,cF as v,Q as ye,R as ke,aq as xe,_ as be,P as we}from"./entry.13466615.js";import{_ as Ce}from"./Button.vue.a83cab3b.js";import{_ as Fe}from"./Overlay.f7b74b5f.js";import{_ as De}from"./Icon.vue.e15b8911.js";import{_ as Ie}from"./DeleteModal.vue.55101b0a.js";import{d as Ae}from"./index.5263eb1d.js";import{a as $e}from"./useSmartsheetStore.9bdf3b91.js";import{i as Re}from"./fileUtils.43128440.js";import{u as Ve}from"./useAttachment.e270c182.js";import{u as Me}from"./index.e7cf7635.js";import{u as Se,a as je,_ as Be,b as Le,c as Oe}from"./index.4fa0cec3.js";import{C as Ue}from"./index.2660048d.js";import{C as Ee}from"./index.3cc83813.js";import{_ as Pe}from"./index.3e3f609f.js";import"./index.f2e6837c.js";import"./debounce.dbc9bf77.js";import"./toNumber.7aa6a805.js";import"./isSymbol.b9109ae5.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Modal.vue.fe6a4790.js";import"./views.3cd4bcb9.js";import"./useMetas.223da623.js";import"./useSharedView.746b4f21.js";import"./index.2a3da6a9.js";import"./urlUtils.f6dc4ebc.js";import"./Tooltip.vue.30df4de9.js";import"./index.a6329415.js";import"./useSmartsheetRowStore.ef2cd001.js";import"./deepCompare.d32ec333.js";import"./dataUtils.31dbfaee.js";import"./virtualCell.88c63e03.js";import"./index.18c65772.js";import"./index.a8ef1b7e.js";import"./Input.16966097.js";import"./antInputDirective.8ac36ea7.js";import"./FormItemContext.27b2e5db.js";import"./SearchOutlined.c1eed30a.js";import"./isPlainObject.4c0f42f1.js";import"./_getPrototype.00be30f0.js";import"./TextArea.1bd4034f.js";import"./Password.d7b16461.js";import"./index.6f605a00.js";import"./FormItem.fe59dafe.js";import"./identity.b813b76e.js";import"./Col.23d910dc.js";import"./responsiveObserve.9209e727.js";import"./toArray.f6fa5a71.js";import"./useSize.dec45296.js";import"./_flatRest.037bf8e3.js";import"./sortable.esm.9c3c89c5.js";import"./Checkbox.65681aa3.js";import"./createForOfIteratorHelper.37be2624.js";import"./index.62e3d60f.js";import"./Dropdown.a78be736.js";import"./useState.a6853ebd.js";import"./useRefs.6ea70d5c.js";import"./isMobile.e2e89480.js";import"./useMergedState.1cc2a884.js";import"./index.638acbb4.js";import"./index.89133b21.js";import"./Input.2c73684e.js";const Ne=ye(()=>ke(()=>import("./Image.e926e9ff.js"),["./Image.e926e9ff.js","./entry.13466615.js","./entry.0f786d51.css"],import.meta.url).then(F=>F.default||F)),ze={class:"flex gap-4"},Te={class:"flex items-center gap-2"},Ze={key:0,class:"text-gray-400"},Ge={class:"font-semibold underline"},qe={key:1,class:"flex flex-1 items-center gap-3 justify-end mr-[30px]"},Ke=l("div",{class:"text-white text-3xl"},"Drop here",-1),Qe={class:"nc-attachment-download group-hover:opacity-100"},We={class:"nc-attachment-download group-hover:opacity-100 mr-[35px]"},He=["title"],Je={key:0,class:"flex flex-col gap-1"},Xe={class:"nc-attachment h-full w-full flex items-center justify-center"},Ye={class:"flex flex-row items-center py-2.25 px-2.5 bg-gray-50 rounded-lg text-gray-700 mb-4"},et={class:"capitalize text-ellipsis overflow-hidden select-none w-full pl-1.75",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},co=pe({__name:"Modal",setup(F){const{isUIAllowed:D}=Me(),{open:L,isLoading:T,isPublic:I,isReadonly:_,visibleItems:O,modalVisible:p,column:Z,FileIcon:G,removeFile:q,onDrop:U,downloadFile:K,updateModelValue:Q,selectedImage:E,selectedVisibleItems:y,bulkDownloadFiles:W,renameFile:H}=Se(),A=de(Ae,b(!1)),$=b(),P=b(),{dragging:R}=je(P,O,Q,_),{isOverDropZone:k}=_e($,U),{isSharedForm:x}=$e(),{getPossibleAttachmentSrc:J,openAttachment:N}=Ve();ue("Escape",()=>{p.value=!1,k.value=!1});function X(c){E.value=c,p.value=!1;const o=xe(E,V=>{V||(setTimeout(()=>{p.value=!0},50),o==null||o())})}const g=b(!1),u=fe({title:"",i:0});function Y(c,o){g.value=!0,u.i=o,u.title=c}he($,"paste",c=>{var o;(o=c.clipboardData)!=null&&o.files&&U(c.clipboardData.files)});const ee=c=>{q(c),g.value=!1,u.i=0,u.title=""};return(c,o)=>{const V=Be,te=Ce,oe=Le,ne=Fe,le=Ue,M=be,ae=Ne,ie=Oe,z=Ee,se=Pe,ce=De,re=Ie,me=we;return n(),i(me,{visible:e(p),"onUpdate:visible":o[3]||(o[3]=t=>j(p)?p.value=t:null),class:w(["nc-attachment-modal",{active:e(p)}]),width:"80%",footer:null,"wrap-class-name":"nc-modal-attachment-expand-cell"},{title:a(()=>{var t;return[l("div",ze,[e(x)||!e(_)&&e(D)("tableAttachment")&&!e(I)&&!e(A)?(n(),f("div",{key:0,class:"nc-attach-file group","data-testid":"attachment-expand-file-picker-button",onClick:o[0]||(o[0]=(...r)=>e(L)&&e(L)(...r))},[s(V,{class:"transform group-hover:text-accent group-hover:scale-120"}),h(" Attach File ")])):m("",!0),l("div",Te,[e(_)?(n(),f("div",Ze,"[Readonly]")):m("",!0),h(" Viewing Attachments of "),l("div",Ge,S((t=e(Z))==null?void 0:t.title),1)]),e(y).includes(!0)?(n(),f("div",qe,[s(te,{type:"primary",class:"nc-attachment-download-all",onClick:e(W)},{default:a(()=>[h(" Bulk Download ")]),_:1},8,["onClick"])])):m("",!0)])]}),default:a(()=>[l("div",{ref_key:"dropZoneRef",ref:$,tabindex:"0"},[e(x)||!e(_)&&!e(R)?(n(),i(ne,{key:0,modelValue:e(k),"onUpdate:modelValue":o[1]||(o[1]=t=>j(k)?k.value=t:null),inline:"",class:"text-white ring ring-accent ring-opacity-100 bg-gray-700/75 flex items-center justify-center gap-2 backdrop-blur-xl"},{default:a(()=>[s(oe,{class:"text-accent",height:"35",width:"35"}),Ke]),_:1},8,["modelValue"])):m("",!0),l("div",{ref_key:"sortableRef",ref:P,class:w([{dragging:e(R)},"grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-6 relative p-6"])},[(n(!0),f(ve,null,ge(e(O),(t,r)=>(n(),f("div",{key:`${t.title}-${r}`,class:"flex flex-col gap-1"},[s(z,{class:"nc-attachment-item group"},{default:a(()=>[s(le,{checked:e(y)[r],"onUpdate:checked":d=>e(y)[r]=d,class:w(["nc-attachment-checkbox group-hover:opacity-100",{"!opacity-100":e(y)[r]}])},null,8,["checked","onUpdate:checked","class"]),e(_)?m("",!0):(n(),i(M,{key:0},{title:a(()=>[h(" Remove File ")]),default:a(()=>[e(x)||e(D)("tableAttachment")&&!e(I)&&!e(A)?(n(),i(C(e(B).closeCircle),{key:0,class:"nc-attachment-remove",onClick:v(d=>Y(t.title,r),["stop"])},null,8,["onClick"])):m("",!0)]),_:2},1024)),s(M,{placement:"bottom"},{title:a(()=>[h(" Download File ")]),default:a(()=>[l("div",Qe,[(n(),i(C(e(B).download),{onClick:v(d=>e(K)(t),["stop"])},null,8,["onClick"]))])]),_:2},1024),e(x)||!e(_)&&e(D)("tableAttachment")&&!e(I)&&!e(A)?(n(),i(M,{key:1,placement:"bottom"},{title:a(()=>[h(" Rename File ")]),default:a(()=>[l("div",We,[(n(),i(C(e(B).edit),{onClick:v(d=>e(H)(t,r),["stop"])},null,8,["onClick"]))])]),_:2},1024)):m("",!0),l("div",{class:w([[e(R)?"cursor-move":"cursor-pointer"],"nc-attachment h-full w-full flex items-center justify-center overflow-hidden"])},[e(Re)(t.title,t.mimetype)?(n(),i(ae,{key:0,srcs:e(J)(t),class:"max-w-full max-h-full m-auto justify-center",onClick:v(d=>X(t),["stop"])},null,8,["srcs","onClick"])):t.icon?(n(),i(C(e(G)(t.icon)),{key:1,height:"150",width:"150",onClick:v(d=>e(N)(t),["stop"])},null,8,["onClick"])):(n(),i(ie,{key:2,height:"150",width:"150",onClick:v(d=>e(N)(t),["stop"])},null,8,["onClick"]))],2)]),_:2},1024),l("div",{class:"truncate",title:t.title},S(t.title),9,He)]))),128)),e(T)?(n(),f("div",Je,[s(z,{class:"nc-attachment-item group"},{default:a(()=>[l("div",Xe,[s(se,{class:""})])]),_:1})])):m("",!0)],2)],512),s(re,{visible:e(g),"onUpdate:visible":o[2]||(o[2]=t=>j(g)?g.value=t:null),"entity-name":"File","on-delete":()=>ee(e(u).i)},{"entity-preview":a(()=>[l("span",null,[l("div",Ye,[s(ce,{icon:"file",class:"nc-view-icon"}),l("div",et,S(e(u).title),1)])])]),_:1},8,["visible","on-delete"])]),_:1},8,["visible","class"])}}});export{co as default};
